<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/images/favicon-32x32.png"><title>é™é»˜ã®Blog</title><meta name="description" content="é™é»˜çš„Vuepress Blog">
    <link rel="preload" href="/assets/js/runtime~app.2c87fbe0.js" as="script"><link rel="preload" href="/assets/css/styles.b779b927.css" as="style"><link rel="preload" href="/assets/js/95615.aba5921d.js" as="script"><link rel="preload" href="/assets/js/app.4aafd1f6.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.b779b927.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">é™é»˜ã®Blog</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item"></p><ul class=""><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#å®¹å™¨applicationcontext" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å®¹å™¨ApplicationContext"><!--[--><!--]--> å®¹å™¨ApplicationContext <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean"><!--[--><!--]--> Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#beançš„ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Beançš„ç”Ÿå‘½å‘¨æœŸ"><!--[--><!--]--> Beançš„ç”Ÿå‘½å‘¨æœŸ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸"><!--[--><!--]--> æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#aop" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="AOP"><!--[--><!--]--> AOP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#äº‹åŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="äº‹åŠ¡"><!--[--><!--]--> äº‹åŠ¡ <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#äº‹åŠ¡å¤±æ•ˆ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="äº‹åŠ¡å¤±æ•ˆ"><!--[--><!--]--> äº‹åŠ¡å¤±æ•ˆ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#configurationçš„ä½œç”¨" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="@Configurationçš„ä½œç”¨"><!--[--><!--]--> @Configurationçš„ä½œç”¨ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#springæ‰‹å†™æºç â¤ï¸" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Springæ‰‹å†™æºç â¤ï¸"><!--[--><!--]--> Springæ‰‹å†™æºç â¤ï¸ <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#æ‰«æ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ‰«æ"><!--[--><!--]--> æ‰«æ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#beançš„ç”Ÿå‘½å‘¨æœŸ-1" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="beançš„ç”Ÿå‘½å‘¨æœŸ"><!--[--><!--]--> beançš„ç”Ÿå‘½å‘¨æœŸ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/spring/02%20Spring%E6%A0%B8%E5%BF%83.html#beanpostprocessorå¤„ç†ä»£ç†" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="BeanPostProcessorå¤„ç†ä»£ç†"><!--[--><!--]--> BeanPostProcessorå¤„ç†ä»£ç† <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="å®¹å™¨applicationcontext" tabindex="-1"><a class="header-anchor" href="#å®¹å™¨applicationcontext" aria-hidden="true">#</a> å®¹å™¨ApplicationContext</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ClassPathXmlApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;spring.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userService<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol><li>ç¬¬ä¸€è¡Œä»£ç ï¼Œä¼šæ„é€ ä¸€ä¸ªClassPathXmlApplicationContextå¯¹è±¡ï¼ŒClassPathXmlApplicationContextè¯¥å¦‚ä½•ç†è§£ï¼Œè°ƒç”¨è¯¥æ„é€ æ–¹æ³•é™¤å¼€ä¼šå®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜ä¼šåšå“ªäº›äº‹æƒ…ï¼Ÿ</li><li>ç¬¬äºŒè¡Œä»£ç ï¼Œä¼šè°ƒç”¨ClassPathXmlApplicationContextçš„getBeanæ–¹æ³•ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªUserServiceå¯¹è±¡ï¼ŒgetBean()æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿè¿”å›çš„UserServiceå¯¹è±¡å’Œæˆ‘ä»¬è‡ªå·±ç›´æ¥newçš„UserServiceå¯¹è±¡æœ‰åŒºåˆ«å—ï¼Ÿ</li><li>ç¬¬ä¸‰è¡Œä»£ç ï¼Œå°±æ˜¯ç®€å•çš„è°ƒç”¨UserServiceçš„test()æ–¹æ³•</li></ol><p>ä½†æ˜¯ç”¨ClassPathXmlApplicationContextå…¶å®å·²ç»è¿‡æ—¶äº†ï¼Œåœ¨æ–°ç‰ˆçš„Spring MVCå’ŒSpring Bootçš„åº•å±‚ä¸»è¦ç”¨çš„éƒ½æ˜¯<strong>AnnotationConfigApplicationContext</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">AnnotationConfigApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;);</span>
<span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userService<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol><li><p>å¯ä»¥çœ‹åˆ°AnnotationConfigApplicationContextçš„ç”¨æ³•å’ŒClassPathXmlApplicationContextæ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œåªä¸è¿‡éœ€è¦ä¼ å…¥çš„æ˜¯ä¸€ä¸ªclassï¼Œè€Œä¸æ˜¯ä¸€ä¸ªxmlæ–‡ä»¶ã€‚</p></li><li><p>è€ŒAppConfig.classå’Œspring.xmlä¸€æ ·ï¼Œè¡¨ç¤ºSpringçš„é…ç½®ï¼Œæ¯”å¦‚å¯ä»¥æŒ‡å®šæ‰«æè·¯å¾„ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰Beanï¼Œæ¯”å¦‚ï¼š</p><ol><li><p>spring.xmlä¸­çš„å†…å®¹ä¸ºï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zhouyu<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zhouyu.service.UserService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p>AppConfigçš„å†…å®¹</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.zhouyu&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">UserService</span> <span class="token function">userService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">UserService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ol><p>æ‰€ä»¥spring.xmlå’ŒAppConfig.classæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„</p></li></ol><p>ç›®å‰ï¼Œæˆ‘ä»¬åŸºæœ¬å¾ˆå°‘ç›´æ¥ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹å¼æ¥ç”¨Springï¼Œè€Œæ˜¯ä½¿ç”¨Spring MVCï¼Œæˆ–è€…Spring Bootï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯åŸºäºä¸Šé¢è¿™ç§æ–¹å¼çš„ï¼Œéƒ½éœ€è¦åœ¨å†…éƒ¨å»åˆ›å»ºä¸€ä¸ªApplicationContextçš„ï¼Œåªä¸è¿‡ï¼š</p><ol><li>Spring MVCåˆ›å»ºçš„æ˜¯<strong>XmlWebApplicationContext</strong>ï¼Œå’Œ<strong>ClassPathXmlApplicationContext</strong>ç±»ä¼¼ï¼Œéƒ½æ˜¯åŸºäºXMLé…ç½®çš„</li><li>Spring Bootåˆ›å»ºçš„æ˜¯<strong>AnnotationConfigApplicationContext</strong></li></ol><h2 id="springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean" tabindex="-1"><a class="header-anchor" href="#springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean" aria-hidden="true">#</a> Springå¦‚ä½•åˆ›å»ºä¸€ä¸ªbean</h2><p>ä¸ç®¡æ˜¯AnnotationConfigApplicationContextè¿˜æ˜¯ClassPathXmlApplicationContextï¼Œç›®å‰ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç®€å•çš„å°†å®ƒä»¬ç†è§£ä¸ºå°±æ˜¯ç”¨æ¥åˆ›å»ºJavaå¯¹è±¡çš„ï¼Œæ¯”å¦‚è°ƒç”¨getBean()å°±ä¼šå»åˆ›å»ºå¯¹è±¡ï¼ˆæ­¤å¤„ä¸ä¸¥è°¨ï¼ŒgetBeanå¯èƒ½ä¹Ÿä¸ä¼šå»åˆ›å»ºå¯¹è±¡)</p><p>åœ¨Javaè¯­è¨€ä¸­ï¼Œè‚¯å®šæ˜¯æ ¹æ®æŸä¸ªç±»æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">AnnotationConfigApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">AppConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">UserService</span> userService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userService<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å½“æˆ‘ä»¬è°ƒç”¨context.getBean(&quot;userService&quot;)æ—¶ï¼Œå°±ä¼šå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯getBeanæ–¹æ³•å†…éƒ¨æ€ä¹ˆçŸ¥é“&quot;userService&quot;å¯¹åº”çš„æ˜¯UserServiceç±»å‘¢ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ†æå‡ºæ¥ï¼Œåœ¨è°ƒç”¨AnnotationConfigApplicationContextçš„æ„é€ æ–¹æ³•æ—¶ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€è¡Œä»£ç ï¼Œä¼šå»åšä¸€äº›äº‹æƒ…ï¼š</p><ol><li>è§£æAppConfig.classï¼Œå¾—åˆ°æ‰«æè·¯å¾„</li><li>éå†æ‰«æè·¯å¾„ä¸‹çš„æ‰€æœ‰Javaç±»ï¼Œå¦‚æœå‘ç°æŸä¸ªç±»ä¸Šå­˜åœ¨@Componentã€@Serviceç­‰æ³¨è§£ï¼Œé‚£ä¹ˆSpringå°±æŠŠè¿™ä¸ªç±»è®°å½•ä¸‹æ¥ï¼Œå­˜åœ¨ä¸€ä¸ªMapä¸­ï¼Œæ¯”å¦‚Map&lt;String, Class&gt;ã€‚ï¼ˆ<strong>å®é™…ä¸Šï¼ŒSpringæºç ä¸­ç¡®å®å­˜åœ¨ç±»ä¼¼çš„è¿™ä¹ˆä¸€ä¸ªMapï¼Œå«åšBeanDefinitionMap</strong>ï¼‰</li><li>Springä¼šæ ¹æ®æŸä¸ªè§„åˆ™ç”Ÿæˆå½“å‰ç±»å¯¹åº”çš„beanNameï¼Œä½œä¸ºkeyå­˜å…¥Mapï¼Œå½“å‰ç±»ä½œä¸ºvalue</li></ol><p>è¿™æ ·ï¼Œä½†è°ƒç”¨context.getBean(&quot;userService&quot;)æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®&quot;userService&quot;æ‰¾åˆ°UserServiceç±»ï¼Œä»è€Œå°±å¯ä»¥å»åˆ›å»ºå¯¹è±¡äº†ã€‚</p><hr><h2 id="beançš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#beançš„ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> Beançš„ç”Ÿå‘½å‘¨æœŸ</h2><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>é‚£ä¹ˆSpringåˆ°åº•æ˜¯å¦‚ä½•æ¥åˆ›å»ºä¸€ä¸ªBeançš„å‘¢ï¼Œè¿™ä¸ªå°±æ˜¯Beanåˆ›å»ºçš„ç”Ÿå‘½å‘¨æœŸ</p></div><p>UserService.class---&gt;æ— å‚æ„é€ æ–¹æ³•ï¼ˆæ¨æ–­æ„é€ æ–¹æ³•ï¼‰---&gt;æ™®é€šå¯¹è±¡---&gt;ä¾èµ–æ³¨å…¥(å±æ€§èµ‹å€¼)---&gt;Awareæ¥å£---&gt;åˆå§‹åŒ–å‰ï¼ˆ@PostConstructï¼‰---&gt;åˆå§‹åŒ–(InitializingBean)---&gt;åˆå§‹åŒ–å(AOP)---&gt;ä»£ç†å¯¹è±¡---&gt;Bean</p><ol><li>åˆ©ç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼ˆä½†æ˜¯å¦‚ä½•ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringåˆ™ä¼šè¿›è¡Œé€‰æ‹©ï¼Œè¿™ä¸ªå«åš<strong>æ¨æ–­æ„é€ æ–¹æ³•</strong>ï¼‰</li><li>å¾—åˆ°ä¸€ä¸ªå¯¹è±¡åï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨è¢«@Autowiredæ³¨è§£äº†çš„å±æ€§ï¼ŒæŠŠè¿™äº›å±æ€§æ‰¾å‡ºæ¥å¹¶ç”±Springè¿›è¡Œèµ‹å€¼ï¼ˆ<strong>ä¾èµ–æ³¨å…¥</strong>ï¼‰</li><li>ä¾èµ–æ³¨å…¥åï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº†BeanNameAwareæ¥å£ã€BeanClassLoaderAwareæ¥å£ã€BeanFactoryAwareæ¥å£ï¼Œå¦‚æœå®ç°äº†ï¼Œå°±è¡¨ç¤ºå½“å‰å¯¹è±¡å¿…é¡»å®ç°è¯¥æ¥å£ä¸­æ‰€å®šä¹‰çš„setBeanName()ã€setBeanClassLoader()ã€setBeanFactory()æ–¹æ³•ï¼Œé‚£Springå°±ä¼šè°ƒç”¨è¿™äº›æ–¹æ³•å¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°ï¼ˆ<strong>Awareå›è°ƒ</strong>ï¼‰</li><li>Awareå›è°ƒåï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªæ–¹æ³•è¢«@PostConstructæ³¨è§£äº†ï¼Œå¦‚æœå­˜åœ¨ï¼ŒSpringä¼šè°ƒç”¨å½“å‰å¯¹è±¡çš„æ­¤æ–¹æ³•ï¼ˆ<strong>åˆå§‹åŒ–å‰</strong>ï¼‰</li><li>ç´§æ¥ç€ï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº†InitializingBeanæ¥å£ï¼Œå¦‚æœå®ç°äº†ï¼Œå°±è¡¨ç¤ºå½“å‰å¯¹è±¡å¿…é¡»å®ç°è¯¥æ¥å£ä¸­çš„afterPropertiesSet()æ–¹æ³•ï¼Œé‚£Springå°±ä¼šè°ƒç”¨å½“å‰å¯¹è±¡ä¸­çš„<code>afterPropertiesSet()</code>æ–¹æ³•ï¼ˆ<strong>åˆå§‹åŒ–</strong>ï¼‰</li><li>æœ€åï¼ŒSpringä¼šåˆ¤æ–­å½“å‰å¯¹è±¡éœ€ä¸éœ€è¦è¿›è¡ŒAOPï¼Œå¦‚æœä¸éœ€è¦é‚£ä¹ˆBeanå°±åˆ›å»ºå®Œäº†ï¼Œå¦‚æœéœ€è¦è¿›è¡ŒAOPï¼Œåˆ™ä¼šè¿›è¡ŒåŠ¨æ€ä»£ç†å¹¶ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡åšä¸ºBeanï¼ˆ<strong>åˆå§‹åŒ–å</strong>ï¼‰</li></ol><p>é€šè¿‡æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“Springæ ¹æ®UserServiceç±»æ¥åˆ›å»ºä¸€ä¸ªBeanæ—¶ï¼š</p><ol><li>å¦‚æœä¸ç”¨è¿›è¡ŒAOPï¼Œé‚£ä¹ˆBeanå°±æ˜¯UserServiceç±»çš„æ„é€ æ–¹æ³•æ‰€å¾—åˆ°çš„å¯¹è±¡ã€‚</li><li>å¦‚æœéœ€è¦è¿›è¡ŒAOPï¼Œé‚£ä¹ˆBeanå°±æ˜¯UserServiceçš„ä»£ç†ç±»æ‰€å®ä¾‹åŒ–å¾—åˆ°çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯UserServiceæœ¬èº«æ‰€å¾—åˆ°çš„å¯¹è±¡ã€‚</li></ol><p>Beanå¯¹è±¡åˆ›å»ºå‡ºæ¥åï¼š</p><ol><li>å¦‚æœå½“å‰Beanæ˜¯å•ä¾‹Beanï¼Œé‚£ä¹ˆä¼šæŠŠè¯¥Beanå¯¹è±¡å­˜å…¥ä¸€ä¸ªMap&lt;String, Object&gt;ï¼ŒMapçš„keyä¸ºbeanNameï¼Œvalueä¸ºBeanå¯¹è±¡ã€‚è¿™æ ·ä¸‹æ¬¡getBeanæ—¶å°±å¯ä»¥ç›´æ¥ä»Mapä¸­æ‹¿åˆ°å¯¹åº”çš„Beanå¯¹è±¡äº†ã€‚ï¼ˆå®é™…ä¸Šï¼Œåœ¨Springæºç ä¸­ï¼Œè¿™ä¸ªMapå°±æ˜¯<strong>å•ä¾‹æ± </strong>ï¼‰</li><li>å¦‚æœå½“å‰Beanæ˜¯åŸå‹Beanï¼Œé‚£ä¹ˆåç»­æ²¡æœ‰å…¶ä»–åŠ¨ä½œï¼Œä¸ä¼šå­˜å…¥ä¸€ä¸ªMapï¼Œä¸‹æ¬¡getBeanæ—¶ä¼šå†æ¬¡æ‰§è¡Œä¸Šè¿°åˆ›å»ºè¿‡ç¨‹ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„Beanå¯¹è±¡ã€‚</li></ol><h2 id="æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸" tabindex="-1"><a class="header-anchor" href="#æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸" aria-hidden="true">#</a> æ¨æ–­æ„é€ æ–¹æ³•â¤ï¸</h2><blockquote><p>Springåœ¨åŸºäºæŸä¸ªç±»ç”ŸæˆBeançš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åˆ©ç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯<strong>å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringä¼šä½¿ç”¨å“ªä¸ªå‘¢</strong></p></blockquote><p>Springçš„åˆ¤æ–­é€»è¾‘å¦‚ä¸‹ï¼š</p><ol><li>å¦‚æœä¸€ä¸ªç±»åªå­˜åœ¨ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œä¸ç®¡è¯¥æ„é€ æ–¹æ³•æ˜¯æ— å‚æ„é€ æ–¹æ³•ï¼Œè¿˜æ˜¯æœ‰å‚æ„é€ æ–¹æ³•ï¼ŒSpringéƒ½ä¼šç”¨è¿™ä¸ªæ„é€ æ–¹æ³•</li><li>å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³• <ol><li>è¿™äº›æ„é€ æ–¹æ³•ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆSpringå°±ä¼šç”¨è¿™ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•</li><li>è¿™äº›æ„é€ æ–¹æ³•ä¸­ï¼Œä¸å­˜åœ¨ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆSpringå°±ä¼š<strong>æŠ¥é”™</strong></li></ol></li></ol><p>Springçš„è®¾è®¡æ€æƒ³æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>å¦‚æœä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆæ²¡å¾—é€‰æ‹©ï¼Œåªèƒ½ç”¨è¿™ä¸ªæ„é€ æ–¹æ³•</li><li>å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringä¸çŸ¥é“å¦‚ä½•é€‰æ‹©ï¼Œå°±ä¼šçœ‹æ˜¯å¦æœ‰æ— å‚çš„æ„é€ æ–¹æ³•ï¼Œå› ä¸ºæ— å‚æ„é€ æ–¹æ³•æœ¬èº«è¡¨ç¤ºäº†ä¸€ç§é»˜è®¤çš„æ„ä¹‰</li><li>ä¸è¿‡å¦‚æœæŸä¸ªæ„é€ æ–¹æ³•ä¸ŠåŠ äº†@Autowiredæ³¨è§£ï¼Œé‚£å°±è¡¨ç¤ºç¨‹åºå‘˜å‘Šè¯‰Springå°±ç”¨è¿™ä¸ªåŠ äº†æ³¨è§£çš„æ–¹æ³•ï¼Œé‚£Springå°±ä¼šç”¨è¿™ä¸ªåŠ äº†@Autowiredæ³¨è§£æ„é€ æ–¹æ³•äº†</li></ol><blockquote><p>éœ€è¦é‡è§†çš„æ˜¯ï¼Œå¦‚æœSpringé€‰æ‹©äº†ä¸€ä¸ªæœ‰å‚çš„æ„é€ æ–¹æ³•ï¼ŒSpringåœ¨è°ƒç”¨è¿™ä¸ªæœ‰å‚æ„é€ æ–¹æ³•æ—¶ï¼Œéœ€è¦ä¼ å…¥å‚æ•°ï¼Œé‚£è¿™ä¸ªå‚æ•°æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ</p></blockquote><p>Springä¼šæ ¹æ®å…¥å‚çš„ç±»å‹å’Œå…¥å‚çš„åå­—å»Springä¸­æ‰¾Beanå¯¹è±¡ï¼ˆä»¥å•ä¾‹Beanä¸ºä¾‹ï¼ŒSpringä¼šä»å•ä¾‹æ± é‚£ä¸ªMapä¸­å»æ‰¾ï¼‰ï¼š</p><ol><li>å…ˆæ ¹æ®å…¥å‚ç±»å‹æ‰¾ï¼Œå¦‚æœåªæ‰¾åˆ°ä¸€ä¸ªï¼Œé‚£å°±ç›´æ¥ç”¨æ¥ä½œä¸ºå…¥å‚</li><li>å¦‚æœæ ¹æ®ç±»å‹æ‰¾åˆ°å¤šä¸ªï¼Œåˆ™å†æ ¹æ®å…¥å‚åå­—æ¥ç¡®å®šå”¯ä¸€ä¸€ä¸ª</li><li>æœ€ç»ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œæ— æ³•åˆ›å»ºå½“å‰Beanå¯¹è±¡</li></ol><blockquote><p>å…ˆç±»å‹ååå­—</p></blockquote><p>ç¡®å®šç”¨å“ªä¸ªæ„é€ æ–¹æ³•ï¼Œç¡®å®šå…¥å‚çš„Beanå¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åš<strong>æ¨æ–­æ„é€ æ–¹æ³•</strong>ã€‚</p><hr><h2 id="aop" tabindex="-1"><a class="header-anchor" href="#aop" aria-hidden="true">#</a> AOP</h2><blockquote><p>AOPå°±æ˜¯è¿›è¡ŒåŠ¨æ€ä»£ç†ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªBeançš„è¿‡ç¨‹ä¸­ï¼ŒSpringåœ¨æœ€åä¸€æ­¥ä¼šå»åˆ¤æ–­å½“å‰æ­£åœ¨åˆ›å»ºçš„è¿™ä¸ªBeanæ˜¯ä¸æ˜¯éœ€è¦è¿›è¡ŒAOPï¼Œå¦‚æœéœ€è¦åˆ™ä¼šè¿›è¡ŒåŠ¨æ€ä»£ç†ã€‚</p></blockquote><p>cglibä»£ç†å¯¹è±¡ï¼Œç»§æ‰¿å…³ç³»ï¼Œä½†æ˜¯å±æ€§targetä¸­æ³¨å…¥äº†æ™®é€šå¯¹è±¡çš„bean</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">UserServiceProxy</span> <span class="token keyword">extends</span> <span class="token class-name">UserService</span><span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">UserService</span> target<span class="token punctuation">;</span>
	<span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªbeanæ˜¯å¦éœ€è¦è¿›è¡Œaop?</p><ol><li>æ‰¾å‡ºæ‰€æœ‰çš„åˆ‡é¢Bean</li><li>éå†åˆ‡é¢ä¸­çš„æ¯ä¸ªæ–¹æ³•ï¼Œçœ‹æ˜¯å¦å†™äº†@Beforeã€@Afterç­‰æ³¨è§£</li><li>å¦‚æœå†™äº†ï¼Œåˆ™åˆ¤æ–­æ‰€å¯¹åº”çš„Pointcutæ˜¯å¦å’Œå½“å‰Beanå¯¹è±¡çš„ç±»æ˜¯å¦åŒ¹é…</li><li>å¦‚æœåŒ¹é…åˆ™è¡¨ç¤ºå½“å‰Beanå¯¹è±¡æœ‰åŒ¹é…çš„çš„Pointcutï¼Œè¡¨ç¤ºéœ€è¦è¿›è¡ŒAOP</li></ol><p>åˆ©ç”¨cglibè¿›è¡ŒAOPçš„å¤§è‡´æµç¨‹ï¼š</p><ol><li><p>ç”Ÿæˆä»£ç†ç±»UserServiceProxyï¼Œä»£ç†ç±»ç»§æ‰¿UserService</p></li><li><p>ä»£ç†ç±»ä¸­é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ¯”å¦‚UserServiceä¸­çš„test()æ–¹æ³•</p></li><li><p>ä»£ç†ç±»ä¸­è¿˜ä¼šæœ‰ä¸€ä¸ªtargetå±æ€§ï¼Œè¯¥å±æ€§çš„å€¼ä¸ºè¢«ä»£ç†å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯é€šè¿‡UserServiceç±»æ¨æ–­æ„é€ æ–¹æ³•å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œè¿›è¡Œäº†ä¾èµ–æ³¨å…¥ã€åˆå§‹åŒ–ç­‰æ­¥éª¤çš„å¯¹è±¡ï¼‰</p></li><li><p>ä»£ç†ç±»ä¸­çš„test()æ–¹æ³•è¢«æ‰§è¡Œæ—¶çš„é€»è¾‘å¦‚ä¸‹ï¼š</p><ol><li>æ‰§è¡Œåˆ‡é¢é€»è¾‘ï¼ˆ@Beforeï¼‰</li><li>è°ƒç”¨target.test()</li></ol></li></ol><p>å½“æˆ‘ä»¬ä»Springå®¹å™¨å¾—åˆ°UserServiceçš„Beanå¯¹è±¡æ—¶ï¼Œæ‹¿åˆ°çš„å°±æ˜¯UserServiceProxyæ‰€ç”Ÿæˆçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä»£ç†å¯¹è±¡ã€‚â€‹UserServiceä»£ç†å¯¹è±¡.test()---&gt;æ‰§è¡Œåˆ‡é¢é€»è¾‘---&gt;target.test()ï¼Œæ³¨æ„targetå¯¹è±¡ä¸æ˜¯ä»£ç†å¯¹è±¡ï¼Œè€Œæ˜¯è¢«ä»£ç†å¯¹è±¡ã€‚</p><hr><h2 id="äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡" aria-hidden="true">#</a> äº‹åŠ¡</h2><p>å½“æˆ‘ä»¬åœ¨æŸä¸ªæ–¹æ³•ä¸ŠåŠ äº†@Transactionalæ³¨è§£åï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•åœ¨è°ƒç”¨æ—¶ä¼šå¼€å¯Springäº‹åŠ¡ï¼Œè€Œè¿™ä¸ªæ–¹æ³•æ‰€åœ¨çš„ç±»æ‰€å¯¹åº”çš„Beanå¯¹è±¡ä¼šæ˜¯è¯¥ç±»çš„ä»£ç†å¯¹è±¡ã€‚ â€‹</p><p>Springäº‹åŠ¡çš„ä»£ç†å¯¹è±¡æ‰§è¡ŒæŸä¸ªæ–¹æ³•æ—¶çš„æ­¥éª¤ï¼š</p><ol><li>åˆ¤æ–­å½“å‰æ‰§è¡Œçš„æ–¹æ³•æ˜¯å¦å­˜åœ¨@Transactionalæ³¨è§£</li><li>å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ©ç”¨äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransactionManangerï¼‰æ–°å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥</li><li>ä¿®æ”¹æ•°æ®åº“è¿æ¥çš„autocommitä¸ºfalse</li><li>æ‰§è¡Œtarget.test()ï¼Œæ‰§è¡Œç¨‹åºå‘˜æ‰€å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œsql</li><li>æ‰§è¡Œå®Œäº†ä¹‹åå¦‚æœæ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™æäº¤ï¼Œå¦åˆ™å›æ»š</li></ol><h3 id="äº‹åŠ¡å¤±æ•ˆ" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡å¤±æ•ˆ" aria-hidden="true">#</a> äº‹åŠ¡å¤±æ•ˆ</h3><blockquote><p>Springäº‹åŠ¡æ˜¯å¦ä¼šå¤±æ•ˆçš„åˆ¤æ–­æ ‡å‡†ï¼š<strong>æŸä¸ªåŠ äº†@Transactionalæ³¨è§£çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¦åˆ¤æ–­åˆ°åº•æ˜¯ä¸æ˜¯ç›´æ¥è¢«ä»£ç†å¯¹è±¡è°ƒç”¨çš„ï¼Œå¦‚æœæ˜¯åˆ™äº‹åŠ¡ä¼šç”Ÿæ•ˆï¼Œå¦‚æœä¸æ˜¯åˆ™å¤±æ•ˆ</strong></p></blockquote><p>è§£å†³æ–¹å¼ï¼š</p><ol><li>åœ¨å¦å¤–ä¸€ä¸ªç±»ä¸­å†™è¿™ä¸ªäº‹åŠ¡ä¼ æ’­çš„æ–¹æ³•</li><li>æˆ–è€…è‡ªå·±æ³¨å…¥è‡ªå·±ï¼Œç„¶åé€šè¿‡è¿™ä¸ªä»£ç†å¯¹è±¡æ‰§è¡Œè¯¥æ–¹æ³•</li></ol><h2 id="configurationçš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#configurationçš„ä½œç”¨" aria-hidden="true">#</a> @Configurationçš„ä½œç”¨</h2><p>åœ¨é…ç½®@Beanæ—¶ï¼Œå¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚dataSource();</p><p>ä¼šç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¦‚AppConfigå¯¹è±¡ï¼Œåœ¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä¸­ä¼šä»å®¹å™¨ä¸­æ¥è·å–è¿™ä¸ªå¯¹è±¡ã€‚</p><h2 id="springæ‰‹å†™æºç â¤ï¸" tabindex="-1"><a class="header-anchor" href="#springæ‰‹å†™æºç â¤ï¸" aria-hidden="true">#</a> Springæ‰‹å†™æºç â¤ï¸</h2><p><a href="https://github.com/Q10Viking/learncode/tree/main/spring/_01-spring-moni" target="_blank" rel="noopener noreferrer">Source Code<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><ol><li>é€šè¿‡æ‰‹å†™æ¨¡æ‹Ÿï¼Œäº†è§£Springçš„åº•å±‚æºç å¯åŠ¨è¿‡ç¨‹</li><li>é€šè¿‡æ‰‹å†™æ¨¡æ‹Ÿï¼Œäº†è§£BeanDefinitionã€BeanPostProcessorçš„æ¦‚å¿µ</li><li>é€šè¿‡æ‰‹å†™æ¨¡æ‹Ÿï¼Œäº†è§£Springè§£æé…ç½®ç±»ç­‰åº•å±‚æºç å·¥ä½œæµç¨‹</li><li>é€šè¿‡æ‰‹å†™æ¨¡æ‹Ÿï¼Œäº†è§£ä¾èµ–æ³¨å…¥ï¼ŒAwareå›è°ƒç­‰åº•å±‚æºç å·¥ä½œæµç¨‹</li><li>é€šè¿‡æ‰‹å†™æ¨¡æ‹Ÿï¼Œäº†è§£Spring AOPçš„åº•å±‚æºç å·¥ä½œæµç¨‹</li></ol><h3 id="æ‰«æ" tabindex="-1"><a class="header-anchor" href="#æ‰«æ" aria-hidden="true">#</a> æ‰«æ</h3><ol><li><p>æ¨¡æ‹Ÿäº†å¦‚ä½•æ‰«æç±»</p><ol><li>æ‹¿åˆ°é…ç½®ä¸­è¦æ‰«æçš„åŒ…ï¼Œç„¶åè½¬ä¸ºç›¸å¯¹è·¯å¾„</li><li>ä½¿ç”¨classloaderé€šè¿‡ç›¸å¯¹è·¯å¾„æ‹¿åˆ°èµ„æºçš„ç»å¯¹è·¯å¾„URL</li><li>æ¥ç€å°±å¯ä»¥å¯ä»¥é€šè¿‡URLåˆ›å»ºä¸€ä¸ªFile,</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>path <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//     com/zhouyu/service</span>

<span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">ZhouyuApplicationContext</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// file:/D:/Github/learncode/spring/_01-spring-moni/target/classes/com/zhouyu/service</span>
<span class="token class-name">URL</span> resource <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>resource<span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="4"><li><p>é€šè¿‡åˆ¤æ–­è¿™ä¸ªFileæ˜¯ä¸æ˜¯ç›®å½•ï¼Œæ¥éå†è¿™ä¸ªç›®å½•ä¸‹çš„æ¯ä¸ªclassæ–‡ä»¶ï¼Œé€šè¿‡classLoaderæ¥åŠ è½½è¿™äº›class</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>åˆ¤æ–­æ˜¯å¦æ ‡æ³¨äº†@Componetæ³¨è§£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>clazz<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li></ol></li><li><p>æ¨¡æ‹Ÿå®ç°äº†å¦‚ä½•å¤„ç†BeanPostProcessorï¼Œåœ¨æ‰«é¢å½“ä¸­å°±å®ä¾‹åŒ–äº†</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BeanPostProcessor</span> instance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span><span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    beanPostProcessorList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p>æ¨¡æ‹Ÿå¤„ç†scopeåŸå‹</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>clazz<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">Scope</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Scope</span> scopeAnnotation <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Scope</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> value <span class="token operator">=</span> scopeAnnotation<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    beanDefinition<span class="token punctuation">.</span><span class="token function">setScope</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    beanDefinition<span class="token punctuation">.</span><span class="token function">setScope</span><span class="token punctuation">(</span><span class="token string">&quot;singleton&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li><li><p>æœ€åå­˜æ”¾åˆ°BeanDefinitionMapä¸­</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>beanDefinitionMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li></ol><h3 id="beançš„ç”Ÿå‘½å‘¨æœŸ-1" tabindex="-1"><a class="header-anchor" href="#beançš„ç”Ÿå‘½å‘¨æœŸ-1" aria-hidden="true">#</a> beançš„ç”Ÿå‘½å‘¨æœŸ</h3><p>å®¹å™¨åœ¨æ‰«æå®ŒbeanDefinitionåå°±ä¼šåˆ›å»ºå•ä¾‹bean</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>beanDefinition<span class="token punctuation">.</span><span class="token function">getScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;singleton&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span> bean <span class="token operator">=</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    singletonObjects<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol><li>æ„é€ å‡½æ•°</li><li>ä¾èµ–æ³¨å…¥</li><li>Awareå‡½æ•°è°ƒç”¨</li><li>å¤„ç†BeanPostProcessor#postProcessBeforeInitialization</li><li>å¤„ç†InitializingBean#afterPropertiesSet</li><li>å¤„ç†BeanPostProcessor#postProcessAfterInitialization</li></ol><details class="custom-container details"><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Object</span> <span class="token function">createBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> beanDefinition<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>

            instance <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">Autowired</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token function">getBean</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token keyword">instanceof</span> <span class="token class-name">BeanNameAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">BeanNameAware</span><span class="token punctuation">)</span>instance<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setBeanName</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span> beanPostProcessor <span class="token operator">:</span> beanPostProcessorList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                instance <span class="token operator">=</span> beanPostProcessor<span class="token punctuation">.</span><span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token keyword">instanceof</span> <span class="token class-name">InitializingBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">InitializingBean</span><span class="token punctuation">)</span>instance<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">BeanPostProcessor</span> beanPostProcessor <span class="token operator">:</span> beanPostProcessorList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                instance <span class="token operator">=</span> beanPostProcessor<span class="token punctuation">.</span><span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InvocationTargetException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>beanDefinitionMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">BeanDefinition</span> beanDefinition <span class="token operator">=</span> beanDefinitionMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>beanDefinition<span class="token punctuation">.</span><span class="token function">getScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;singleton&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> singletonBean <span class="token operator">=</span> singletonObjects<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>singletonBean <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                singletonBean <span class="token operator">=</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
                singletonObjects<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> singletonBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> singletonBean<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// åŸå‹</span>
            <span class="token class-name">Object</span> prototypeBean <span class="token operator">=</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> prototypeBean<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div></details><h3 id="beanpostprocessorå¤„ç†ä»£ç†" tabindex="-1"><a class="header-anchor" href="#beanpostprocessorå¤„ç†ä»£ç†" aria-hidden="true">#</a> BeanPostProcessorå¤„ç†ä»£ç†</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ZhouyuBeanPostProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>beanName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> proxyInstance <span class="token operator">=</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token class-name">ZhouyuBeanPostProcessor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bean<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                    <span class="token comment">// åˆ‡é¢</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ‡é¢é€»è¾‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> proxyInstance<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// bean</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/spring/" class="nav-link router-link-active" aria-label="Back To ç›®å½•"><!--[--><!--]--> Back To ç›®å½• <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.2c87fbe0.js" defer></script><script src="/assets/js/95615.aba5921d.js" defer></script><script src="/assets/js/app.4aafd1f6.js" defer></script>
  </body>
</html>
