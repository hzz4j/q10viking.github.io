<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/images/favicon-32x32.png"><title>é™é»˜ã®Blog</title><meta name="description" content="é™é»˜çš„Vuepress Blog">
    <link rel="preload" href="/assets/js/runtime~app.2c87fbe0.js" as="script"><link rel="preload" href="/assets/css/styles.b779b927.css" as="style"><link rel="preload" href="/assets/js/95615.aba5921d.js" as="script"><link rel="preload" href="/assets/js/app.4aafd1f6.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.b779b927.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">é™é»˜ã®Blog</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item"></p><ul class=""><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#ä¾èµ–" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ä¾èµ–"><!--[--><!--]--> ä¾èµ– <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±»" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±»"><!--[--><!--]--> æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±» <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#hzzspringbootapplicationæ³¨è§£" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="@HZZSpringBootApplicationæ³¨è§£"><!--[--><!--]--> @HZZSpringBootApplicationæ³¨è§£ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#hzzspringapplication" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="HZZSpringApplication"><!--[--><!--]--> HZZSpringApplication <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#runæ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="runæ–¹æ³•"><!--[--><!--]--> runæ–¹æ³• <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#åˆ›å»ºspringå®¹å™¨" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="åˆ›å»ºSpringå®¹å™¨"><!--[--><!--]--> åˆ›å»ºSpringå®¹å™¨ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#å¯åŠ¨tomcat" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å¯åŠ¨Tomcat"><!--[--><!--]--> å¯åŠ¨Tomcat <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#å®ç°tomcatå’Œjettyåˆ‡æ¢" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å®ç°Tomcatå’ŒJettyåˆ‡æ¢"><!--[--><!--]--> å®ç°Tomcatå’ŒJettyåˆ‡æ¢ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£"><!--[--><!--]--> æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±»" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±»"><!--[--><!--]--> æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±» <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#spi" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="SPI"><!--[--><!--]--> SPI <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#æµ‹è¯•" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æµ‹è¯•"><!--[--><!--]--> æµ‹è¯• <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#tomcat" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="tomcat"><!--[--><!--]--> tomcat <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/07%20%E6%89%8B%E5%86%99springboot.html#jetty" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="jetty"><!--[--><!--]--> jetty <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><div class="custom-container tip"><p class="custom-container-title">TIP</p><ol><li>æ‰‹å†™æ¨¡æ‹ŸSpringBootå¯åŠ¨è¿‡ç¨‹</li><li>æ‰‹å†™æ¨¡æ‹ŸSpringBootæ¡ä»¶æ³¨è§£åŠŸèƒ½</li><li>æ‰‹å†™æ¨¡æ‹ŸSpringBootè‡ªåŠ¨é…ç½®åŠŸèƒ½</li><li>SpringBootæ•´åˆTomcatåº•å±‚æºç åˆ†æ</li></ol></div><p><a href="https://github.com/Q10Viking/learncode/tree/main/springboot/hzz-springboot/hzz-springboot" target="_blank" rel="noopener noreferrer">Source Code<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#ä¾èµ–" aria-hidden="true">#</a> ä¾èµ–</h2><blockquote><p>å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œä¸¤ä¸ªModule:</p><ol><li>springbootæ¨¡å—ï¼Œè¡¨ç¤ºspringbootæ¡†æ¶çš„æºç å®ç°</li><li>useråŒ…ï¼Œè¡¨ç¤ºç”¨æˆ·ä¸šåŠ¡ç³»ç»Ÿï¼Œç”¨æ¥å†™ä¸šåŠ¡ä»£ç æ¥æµ‹è¯•æˆ‘ä»¬æ‰€æ¨¡æ‹Ÿå‡ºæ¥çš„SpringBoot</li></ol></blockquote><p><img src="/images/springboot/image-20230406224758560.png" alt="image-20230406224758560"></p><blockquote><p>é¦–å…ˆï¼ŒSpringBootæ˜¯åŸºäºçš„Springï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¾èµ–Springï¼Œç„¶åæˆ‘å¸Œæœ›æˆ‘ä»¬æ¨¡æ‹Ÿå‡ºæ¥çš„SpringBootä¹Ÿæ”¯æŒSpring MVCçš„é‚£ä¸€å¥—åŠŸèƒ½ï¼Œæ‰€ä»¥ä¹Ÿè¦ä¾èµ–Spring MVCï¼ŒåŒ…æ‹¬Tomcatç­‰ï¼Œæ‰€ä»¥åœ¨SpringBootæ¨¡å—ä¸­è¦æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p></blockquote><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.18<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javax.servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>9.0.73<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><blockquote><p>åœ¨Useræ¨¡å—ä¸‹æˆ‘ä»¬è¿›è¡Œæ­£å¸¸çš„å¼€å‘å°±è¡Œäº†ï¼Œæ¯”å¦‚å…ˆæ·»åŠ SpringBootä¾èµ–ï¼š</p></blockquote><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hzz.springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ç„¶åå®šä¹‰ç›¸å…³çš„Controllerå’ŒService:</p><p><img src="/images/springboot/image-20230406230224785.png" alt="image-20230406230224785"></p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>å› ä¸ºæˆ‘ä»¬æ¨¡æ‹Ÿå®ç°çš„æ˜¯SpringBootï¼Œè€Œä¸æ˜¯SpringMVCï¼Œæ‰€ä»¥æˆ‘ç›´æ¥åœ¨useråŒ…ä¸‹å®šä¹‰äº†UserControllerå’ŒUserServiceï¼Œæœ€ç»ˆæˆ‘å¸Œæœ›èƒ½è¿è¡ŒMyApplicationä¸­çš„mainæ–¹æ³•ï¼Œå°±ç›´æ¥å¯åŠ¨äº†é¡¹ç›®ï¼Œå¹¶èƒ½åœ¨æµè§ˆå™¨ä¸­æ­£å¸¸çš„è®¿é—®åˆ°UserControllerä¸­çš„æŸä¸ªæ–¹æ³•ã€‚</p></div><h2 id="æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±»" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±»" aria-hidden="true">#</a> <strong>æ ¸å¿ƒæ³¨è§£å’Œæ ¸å¿ƒç±»</strong></h2><p>æˆ‘ä»¬åœ¨çœŸæ­£ä½¿ç”¨SpringBootæ—¶ï¼Œæ ¸å¿ƒä¼šç”¨åˆ°SpringBootä¸€ä¸ªç±»å’Œæ³¨è§£ï¼š</p><ol><li>@SpringBootApplicationï¼Œè¿™ä¸ªæ³¨è§£æ˜¯åŠ åœ¨åº”ç”¨å¯åŠ¨ç±»ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯mainæ–¹æ³•æ‰€åœ¨çš„ç±»</li><li>SpringApplicationï¼Œè¿™ä¸ªç±»ä¸­æœ‰ä¸ªrun()æ–¹æ³•ï¼Œç”¨æ¥å¯åŠ¨SpringBootåº”ç”¨çš„</li></ol><p>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ¥æ¨¡æ‹Ÿå®ç°ä»–ä»¬ã€‚</p><h3 id="hzzspringbootapplicationæ³¨è§£" tabindex="-1"><a class="header-anchor" href="#hzzspringbootapplicationæ³¨è§£" aria-hidden="true">#</a> @HZZSpringBootApplicationæ³¨è§£</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ComponentScan</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">HZZSpringBootApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="hzzspringapplication" tabindex="-1"><a class="header-anchor" href="#hzzspringapplication" aria-hidden="true">#</a> HZZSpringApplication</h3><p>ä¸€ä¸ªç”¨æ¥å®ç°å¯åŠ¨é€»è¾‘çš„HZZSpringApplicationç±»ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HZZSpringApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>æœ‰äº†ä»¥ä¸Šä¸¤è€…ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨Applicationä¸­æ¥ä½¿ç”¨äº†ï¼Œæ¯”å¦‚ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@HZZSpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">HZZSpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="runæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#runæ–¹æ³•" aria-hidden="true">#</a> <strong>runæ–¹æ³•</strong></h2><p>runæ–¹æ³•ä¸­éœ€è¦å®ç°ä»€ä¹ˆå…·ä½“çš„é€»è¾‘å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¸Œæœ›runæ–¹æ³•ä¸€æ—¦æ‰§è¡Œå®Œï¼Œæˆ‘ä»¬å°±èƒ½åœ¨æµè§ˆå™¨ä¸­è®¿é—®åˆ°UserControllerï¼Œé‚£åŠ¿å¿…åœ¨runæ–¹æ³•ä¸­è¦å¯åŠ¨Tomcatï¼Œé€šè¿‡Tomcatå°±èƒ½æ¥æ”¶åˆ°è¯·æ±‚äº†ã€‚</p><p>Spring MVCçš„åº•å±‚åŸç†ï¼Œåœ¨SpringMVCä¸­æœ‰ä¸€ä¸ªServletéå¸¸æ ¸å¿ƒï¼Œé‚£å°±æ˜¯DispatcherServletï¼Œè¿™ä¸ªDispatcherServletéœ€è¦ç»‘å®šä¸€ä¸ªSpringå®¹å™¨ï¼Œå› ä¸ºDispatcherServletæ¥æ”¶åˆ°è¯·æ±‚åï¼Œå°±ä¼šä»æ‰€ç»‘å®šçš„Springå®¹å™¨ä¸­æ‰¾åˆ°æ‰€åŒ¹é…çš„Controllerï¼Œå¹¶æ‰§è¡Œæ‰€åŒ¹é…çš„æ–¹æ³•ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨runæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¦å®ç°çš„é€»è¾‘å¦‚ä¸‹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªSpringå®¹å™¨</li><li>åˆ›å»ºTomcatå¯¹è±¡</li><li>ç”ŸæˆDispatcherServletå¯¹è±¡ï¼Œå¹¶ä¸”å’Œå‰é¢åˆ›å»ºå‡ºæ¥çš„Springå®¹å™¨è¿›è¡Œç»‘å®š</li><li>å°†DispatcherServletæ·»åŠ åˆ°Tomcatä¸­</li><li>å¯åŠ¨Tomcat</li></ol><h3 id="åˆ›å»ºspringå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºspringå®¹å™¨" aria-hidden="true">#</a> åˆ›å»ºSpringå®¹å™¨</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HZZSpringApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">AnnotationConfigWebApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigWebApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æˆ‘ä»¬åˆ›å»ºçš„æ˜¯ä¸€ä¸ªAnnotationConfigWebApplicationContextå®¹å™¨ï¼Œå¹¶ä¸”æŠŠrunæ–¹æ³•ä¼ å…¥è¿›æ¥çš„classä½œä¸ºå®¹å™¨çš„é…ç½®ç±»ï¼Œæ¯”å¦‚åœ¨MyApplicationçš„runæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯æŠŠ<strong>Application.class</strong>ä¼ å…¥åˆ°äº†runæ–¹æ³•ä¸­ï¼Œæœ€ç»ˆApplicationå°±æ˜¯æ‰€åˆ›å»ºå‡ºæ¥çš„Springå®¹å™¨çš„é…ç½®ç±»ï¼Œå¹¶ä¸”ç”±äºApplicationç±»ä¸Šæœ‰@HZZSpringBootApplicationæ³¨è§£ï¼Œè€Œ@HZZSpringBootApplicationæ³¨è§£çš„å®šä¹‰ä¸Šåˆå­˜åœ¨@ComponentScanæ³¨è§£ï¼Œæ‰€ä»¥AnnotationConfigWebApplicationContextå®¹å™¨åœ¨æ‰§è¡Œrefreshæ—¶ï¼Œå°±ä¼šè§£æApplicationè¿™ä¸ªé…ç½®ç±»ï¼Œä»è€Œå‘ç°å®šä¹‰äº†@ComponentScanæ³¨è§£ï¼Œä¹Ÿå°±çŸ¥é“äº†è¦<strong>è¿›è¡Œæ‰«æ</strong>ï¼Œåªä¸è¿‡æ‰«æè·¯å¾„ä¸ºç©ºï¼Œè€ŒAnnotationConfigWebApplicationContextå®¹å™¨ä¼šå¤„ç†è¿™ç§æƒ…å†µï¼Œ<strong>å¦‚æœæ‰«æè·¯å¾„ä¼šç©ºï¼Œåˆ™ä¼šå°†Applicationæ‰€åœ¨çš„åŒ…è·¯å¾„åšä¸ºæ‰«æè·¯å¾„</strong>ï¼Œä»è€Œå°±ä¼šæ‰«æåˆ°UserServiceå’ŒUserControllerã€‚</p><p>æ‰€ä»¥Springå®¹å™¨åˆ›å»ºå®Œä¹‹åï¼Œå®¹å™¨å†…éƒ¨å°±æ‹¥æœ‰äº†UserServiceå’ŒUserControllerè¿™ä¸¤ä¸ªBeanã€‚</p><h3 id="å¯åŠ¨tomcat" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨tomcat" aria-hidden="true">#</a> å¯åŠ¨Tomcat</h3><p>æˆ‘ä»¬ç”¨çš„æ˜¯Embed-Tomcatï¼Œä¹Ÿå°±æ˜¯å†…åµŒçš„Tomcatï¼ŒçœŸæ­£çš„SpringBootä¸­ä¹Ÿç”¨çš„æ˜¯å†…åµŒçš„Tomcatï¼Œè€Œå¯¹äºå¯åŠ¨å†…åµŒçš„Tomcatï¼Œä¹Ÿå¹¶ä¸éº»çƒ¦ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">startTomcat</span><span class="token punctuation">(</span><span class="token class-name">WebApplicationContext</span> webApplicationContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">Tomcat</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Server</span> server <span class="token operator">=</span> tomcat<span class="token punctuation">.</span><span class="token function">getServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Service</span> service <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">findService</span><span class="token punctuation">(</span><span class="token string">&quot;Tomcat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Connector</span> connector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connector</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP/1.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connector<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token class-name">StandardEngine</span> engine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    engine<span class="token punctuation">.</span><span class="token function">setDefaultHost</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">StandardHost</span> host <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    host<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> contextPath <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">addLifecycleListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Tomcat<span class="token punctuation">.</span>FixContextListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    host<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    engine<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">;</span>
    service<span class="token punctuation">.</span><span class="token function">setContainer</span><span class="token punctuation">(</span>engine<span class="token punctuation">)</span><span class="token punctuation">;</span>
    service<span class="token punctuation">.</span><span class="token function">addConnector</span><span class="token punctuation">(</span>connector<span class="token punctuation">)</span><span class="token punctuation">;</span>

    tomcat<span class="token punctuation">.</span><span class="token function">addServlet</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">,</span> <span class="token string">&quot;dispatcher&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DispatcherServlet</span><span class="token punctuation">(</span>webApplicationContext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">addServletMappingDecoded</span><span class="token punctuation">(</span><span class="token string">&quot;/*&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dispatcher&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        tomcat<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>ä»£ç è™½ç„¶çœ‹ä¸Šå»æ¯”è¾ƒå¤šï¼Œä½†æ˜¯é€»è¾‘å¹¶ä¸å¤æ‚ï¼Œæ¯”å¦‚é…ç½®äº†Tomcatç»‘å®šçš„ç«¯å£ä¸º8081ï¼Œåé¢å‘å½“å‰Tomcatä¸­æ·»åŠ äº†DispatcherServletï¼Œå¹¶è®¾ç½®äº†ä¸€ä¸ªMappingå…³ç³»ï¼Œæœ€åå¯åŠ¨ï¼Œå…¶ä»–ä»£ç åˆ™ä¸ç”¨å¤ªè¿‡å…³å¿ƒã€‚</p><p>è€Œä¸”åœ¨æ„é€ DispatcherServletå¯¹è±¡æ—¶ï¼Œä¼ å…¥äº†ä¸€ä¸ªApplicationContextå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªSpringå®¹å™¨ï¼Œå°±æ˜¯æˆ‘ä»¬å‰æ–‡è¯´çš„ï¼ŒDispatcherServletå¯¹è±¡å’Œä¸€ä¸ªSpringå®¹å™¨è¿›è¡Œç»‘å®šã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨runæ–¹æ³•ä¸­ï¼Œè°ƒç”¨startTomcatå³å¯ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AnnotationConfigWebApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigWebApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">startTomcat</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>å®é™…ä¸Šä»£ç å†™åˆ°è¿™ï¼Œä¸€ä¸ªæåº¦ç²¾ç®€ç‰ˆçš„SpringBootå°±å†™å‡ºæ¥äº†ï¼Œæ¯”å¦‚ç°åœ¨è¿è¡ŒMyApplicationï¼Œå°±èƒ½æ­£å¸¸çš„å¯åŠ¨é¡¹ç›®ï¼Œå¹¶èƒ½æ¥æ”¶è¯·æ±‚ã€‚</p><p>å¯åŠ¨èƒ½çœ‹åˆ°Tomcatçš„å¯åŠ¨æ—¥å¿—ï¼š</p><p><img src="/images/springboot/image-20230406234237246.png" alt="image-20230406234237246"></p><p>ç„¶ååœ¨æµè§ˆå™¨ä¸Šè®¿é—®ï¼šhttp://localhost:8081/test,ä¹Ÿèƒ½æ­£å¸¸çš„çœ‹åˆ°ç»“æœ</p><p><img src="/images/springboot/image-20230406234325235.png" alt="image-20230406234325235"></p><h2 id="å®ç°tomcatå’Œjettyåˆ‡æ¢" tabindex="-1"><a class="header-anchor" href="#å®ç°tomcatå’Œjettyåˆ‡æ¢" aria-hidden="true">#</a> å®ç°Tomcatå’ŒJettyåˆ‡æ¢</h2><p>è™½ç„¶æˆ‘ä»¬å‰é¢å·²ç»å®ç°äº†ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„SpringBootï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ç»§ç»­æ¥æ‰©å……å®ƒçš„åŠŸèƒ½ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚ï¼Œè¿™ä¸ªéœ€æ±‚å°±æ˜¯æˆ‘ç°åœ¨ä¸æƒ³ä½¿ç”¨Tomcatäº†ï¼Œè€Œæ˜¯æƒ³è¦ç”¨Jettyï¼Œé‚£è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>æˆ‘ä»¬å‰é¢ä»£ç ä¸­é»˜è®¤å¯åŠ¨çš„æ˜¯Tomcatï¼Œé‚£æˆ‘ç°åœ¨æƒ³æ”¹æˆè¿™æ ·å­ï¼š</p><ol><li>å¦‚æœé¡¹ç›®ä¸­æœ‰Tomcatçš„ä¾èµ–ï¼Œé‚£å°±å¯åŠ¨Tomcat</li><li>å¦‚æœé¡¹ç›®ä¸­æœ‰Jettyçš„ä¾èµ–å°±å¯åŠ¨Jetty</li><li>å¦‚æœä¸¤è€…éƒ½æ²¡æœ‰åˆ™æŠ¥é”™</li><li>å¦‚æœä¸¤è€…éƒ½æœ‰ä¹ŸæŠ¥é”™</li></ol><p>è¿™ä¸ªé€»è¾‘å¸Œæœ›SpringBootè‡ªåŠ¨å¸®æˆ‘å®ç°ï¼Œå¯¹äºç¨‹åºå‘˜ç”¨æˆ·è€Œè¨€ï¼Œåªè¦åœ¨Pomæ–‡ä»¶ä¸­æ·»åŠ ç›¸å…³ä¾èµ–å°±å¯ä»¥äº†ï¼Œæƒ³ç”¨Tomcatå°±åŠ Tomcatä¾èµ–ï¼Œæƒ³ç”¨Jettyå°±åŠ Jettyä¾èµ–ã€‚</p><p>é‚£SpringBootè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸ç®¡æ˜¯Tomcatè¿˜æ˜¯Jettyï¼Œå®ƒä»¬éƒ½æ˜¯åº”ç”¨æœåŠ¡å™¨ï¼Œæˆ–è€…æ˜¯Servletå®¹å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®šä¹‰æ¥å£æ¥è¡¨ç¤ºå®ƒä»¬ï¼Œè¿™ä¸ªæ¥å£å«åšWebServer,å¹¶ä¸”åœ¨è¿™ä¸ªæ¥å£ä¸­å®šä¹‰ä¸€ä¸ªstartæ–¹æ³•ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">WebServer</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>æœ‰äº†WebServeræ¥å£ä¹‹åï¼Œå°±é’ˆå¯¹Tomcatå’ŒJettyæä¾›ä¸¤ä¸ªå®ç°ç±»ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TomcatServer</span> <span class="token keyword">implements</span> <span class="token class-name">WebServer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;TomcatServer start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JettyServer</span> <span class="token keyword">implements</span> <span class="token class-name">WebServer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JettyServer start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è€Œåœ¨HZZSpringApplicationä¸­çš„runæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°±è¦å»è·å–å¯¹åº”çš„WebServerï¼Œç„¶åå¯åŠ¨å¯¹åº”çš„webServerï¼Œä»£ç ä¸º</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AnnotationConfigWebApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigWebApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    context<span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">WebServer</span> webServer <span class="token operator">=</span> <span class="token function">getWebServer</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    webServer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WebServer</span> <span class="token function">getWebServer</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±åªéœ€è¦åœ¨getWebServeræ–¹æ³•ä¸­å»åˆ¤æ–­åˆ°åº•è¯¥è¿”å›TomcatWebServerè¿˜æ˜¯JettyWebServerã€‚</p><p>å‰é¢æåˆ°è¿‡ï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®é¡¹ç›®ä¸­çš„ä¾èµ–æƒ…å†µï¼Œæ¥å†³å®šåˆ°åº•ç”¨å“ªä¸ªWebServerï¼Œæˆ‘å°±ç›´æ¥ç”¨SpringBootä¸­çš„æºç å®ç°æ–¹å¼æ¥æ¨¡æ‹Ÿäº†ã€‚</p><h2 id="æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£" aria-hidden="true">#</a> <strong>æ¨¡æ‹Ÿå®ç°æ¡ä»¶æ³¨è§£</strong></h2><p>é¦–å…ˆæˆ‘ä»¬å¾—å®ç°ä¸€ä¸ªæ¡ä»¶æ³¨è§£@ZhouyuConditionalOnClassï¼Œå¯¹åº”ä»£ç å¦‚ä¸‹</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">HZZOnClassCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">HZZConditionalOnClass</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æ³¨æ„æ ¸å¿ƒä¸º@Conditional(HZZOnClassCondition.class)ä¸­çš„HZZOnClassConditionï¼Œå› ä¸º å®ƒæ‰æ˜¯çœŸæ­£å¾—æ¡ä»¶é€»è¾‘</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HZZOnClassCondition</span> <span class="token keyword">implements</span> <span class="token class-name">Condition</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> annotationAttributes <span class="token operator">=</span> metadata<span class="token punctuation">.</span><span class="token function">getAllAnnotationAttributes</span><span class="token punctuation">(</span><span class="token class-name">HZZConditionalOnClass</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> annotationAttributes<span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            context<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å…·ä½“é€»è¾‘ä¸ºï¼Œæ‹¿åˆ°@HZZConditionalOnClassä¸­çš„valueå±æ€§ï¼Œç„¶åç”¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œå¦‚æœåŠ  è½½åˆ°äº†æ‰€æŒ‡å®šçš„è¿™ä¸ªç±»ï¼Œé‚£å°±è¡¨ç¤ºç¬¦åˆæ¡ä»¶ï¼Œå¦‚æœåŠ è½½ä¸åˆ°ï¼Œåˆ™è¡¨ç¤ºä¸ç¬¦åˆæ¡ä»¶ã€‚</p><h2 id="æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±»" aria-hidden="true">#</a> <strong>æ¨¡æ‹Ÿå®ç°è‡ªåŠ¨é…ç½®ç±»</strong></h2><p>æœ‰äº†æ¡ä»¶æ³¨è§£ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥ä½¿ç”¨å®ƒäº†ï¼Œé‚£å¦‚ä½•å®ç°å‘¢ï¼Ÿè¿™é‡Œå°±è¦ç”¨åˆ°è‡ªåŠ¨é…ç½®ç±»çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å…ˆçœ‹ä»£ç ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebServiceAutoConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@HZZConditionalOnClass</span><span class="token punctuation">(</span><span class="token string">&quot;org.apache.catalina.startup.Tomcat&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">TomcatServer</span> <span class="token function">tomcatServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@HZZConditionalOnClass</span><span class="token punctuation">(</span><span class="token string">&quot;org.eclipse.jetty.server.Server&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">JettyServer</span> <span class="token function">jettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>è¿™ä¸ªä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œé€šè¿‡ä¸€ä¸ªWebServiceAutoConfigurationçš„Springé…ç½®ç±»ï¼Œåœ¨é‡Œé¢å®šä¹‰äº†ä¸¤ä¸ªBeanï¼Œä¸€ä¸ªTomcatServerï¼Œä¸€ä¸ªJettyServerï¼Œä¸è¿‡è¿™ä¸¤ä¸ªè¦ç”Ÿæ•ˆçš„å‰ææ˜¯ç¬¦åˆå½“å‰æ‰€æŒ‡å®šçš„æ¡ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ol><li>åªæœ‰å­˜åœ¨&quot;org.apache.catalina.startup.Tomcat&quot;ç±»ï¼Œé‚£ä¹ˆæ‰æœ‰TomcatServerè¿™ä¸ªBean</li><li>åªæœ‰å­˜åœ¨&quot;org.eclipse.jetty.server.Server&quot;ç±»ï¼Œé‚£ä¹ˆæ‰æœ‰JettyServerè¿™ä¸ªBean</li></ol><p>å¹¶ä¸”æˆ‘ä»¬åªéœ€è¦åœ¨HZZSpringApplicationä¸­getWebServeræ–¹æ³•ï¼Œå¦‚æ­¤å®ç°</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">WebServer</span> <span class="token function">getWebServer</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// keyä¸ºbeanName, valueä¸ºBeanå¯¹è±¡</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">WebServer</span><span class="token punctuation">&gt;</span></span>  webServers <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span><span class="token class-name">WebServer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>webServers<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;æ²¡æœ‰æ‰¾åˆ°WebServerçš„å®ç°ç±»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>webServers<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰¾åˆ°å¤šä¸ªWebServerçš„å®ç°ç±»&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> webServers<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿™æ ·æ•´ä½“SpringBootå¯åŠ¨é€»è¾‘å°±æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªAnnotationConfigWebApplicationContextå®¹å™¨</li><li>è§£æApplicationç±»ï¼Œç„¶åè¿›è¡Œæ‰«æ</li><li>é€šè¿‡getWebServeræ–¹æ³•ä»Springå®¹å™¨ä¸­è·å–WebServerç±»å‹çš„Bean</li><li>è°ƒç”¨WebServerå¯¹è±¡çš„startæ–¹æ³•</li></ol><h2 id="spi" tabindex="-1"><a class="header-anchor" href="#spi" aria-hidden="true">#</a> SPI</h2><p>æœ‰äº†ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬è¿˜å·®äº†ä¸€ä¸ªå…³é”®æ­¥éª¤ï¼Œå°±æ˜¯Springè¦èƒ½è§£æåˆ°WebServiceAutoConfigurationè¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ï¼Œå› ä¸ºä¸ç®¡è¿™ä¸ªç±»é‡Œå†™äº†ä»€ä¹ˆä»£ç ï¼ŒSpringä¸å»è§£æå®ƒï¼Œé‚£éƒ½æ˜¯æ²¡ç”¨çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦SpringBootåœ¨runæ–¹æ³•ä¸­ï¼Œèƒ½æ‰¾åˆ°WebServiceAutoConfigurationè¿™ä¸ªé…ç½®ç±»å¹¶æ·»åŠ åˆ°Springå®¹å™¨ä¸­ã€‚</p><p>MyApplicationæ˜¯Springçš„ä¸€ä¸ªé…ç½®ç±»ï¼Œä½†æ˜¯MyApplicationæ˜¯æˆ‘ä»¬ä¼ é€’ç»™SpringBootï¼Œä»è€Œæ·»åŠ åˆ°Springå®¹å™¨ä¸­å»çš„ï¼Œè€ŒWebServiceAutoConfigurationå°±éœ€è¦SpringBootå»è‡ªåŠ¨å‘ç°ï¼Œè€Œä¸éœ€è¦ç¨‹åºå‘˜åšä»»ä½•é…ç½®æ‰èƒ½æŠŠå®ƒæ·»åŠ åˆ°Springå®¹å™¨ä¸­å»ï¼Œè€Œä¸”è¦æ³¨æ„çš„æ˜¯ï¼ŒSpringå®¹å™¨æ‰«æä¹Ÿæ˜¯æ‰«æä¸åˆ°WebServiceAutoConfigurationè¿™ä¸ªç±»çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ‰«æè·¯å¾„æ˜¯&quot;com.zhouyu.user&quot;ï¼Œè€ŒWebServiceAutoConfigurationæ‰€åœ¨çš„åŒ…è·¯å¾„ä¸º&quot;com.zhouyu.springboot&quot;ã€‚</p><p>é‚£SpringBootä¸­æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿé€šè¿‡SPIï¼Œå½“ç„¶SpringBootä¸­è‡ªå·±å®ç°äº†ä¸€å¥—SPIæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„spring.factoriesæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¨¡æ‹Ÿå°±ä¸æå¤æ‚äº†ï¼Œå°±ç›´æ¥ç”¨JDKè‡ªå¸¦çš„SPIæœºåˆ¶ã€‚</p><p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦åœ¨springbooté¡¹ç›®ä¸­çš„resourcesç›®å½•ä¸‹æ·»åŠ å¦‚ä¸‹ç›®å½•ï¼ˆMETA-INF/servicesï¼‰å’Œæ–‡ä»¶ï¼š</p><p><img src="/images/springboot/image-20230407105422949.png" alt="image-20230407105422949"></p><p>SPIçš„é…ç½®å°±å®Œæˆäº†ï¼Œç›¸å½“äºé€šè¿‡org.hzz.springboot.AutoConfigurationæ–‡ä»¶é…ç½®äº†springbootä¸­æ‰€æä¾›çš„é…ç½®ç±»ã€‚</p><p>å¹¶ä¸”æä¾›ä¸€ä¸ªæ¥å£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AutoConfiguration</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å¹¶ä¸”WebServiceAutoConfigurationå®ç°è¯¥æ¥å£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebServiceAutoConfiguration</span> <span class="token keyword">implements</span> <span class="token class-name">AutoConfiguration</span><span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@HZZConditionalOnClass</span><span class="token punctuation">(</span><span class="token string">&quot;org.apache.catalina.startup.Tomcat&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">TomcatServer</span> <span class="token function">tomcatServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@HZZConditionalOnClass</span><span class="token punctuation">(</span><span class="token string">&quot;org.eclipse.jetty.server.Server&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">JettyServer</span> <span class="token function">jettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JettyServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ç„¶åæˆ‘ä»¬å†åˆ©ç”¨springä¸­çš„@ImportæŠ€æœ¯æ¥å¯¼å…¥è¿™äº›é…ç½®ç±»ï¼Œæˆ‘ä»¬åœ¨@HZZSpringBootApplicationçš„å®šä¹‰ä¸Šå¢åŠ å¦‚ä¸‹ä»£ç :</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ComponentScan</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">HZZImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">HZZSpringBootApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HZZImportSelector</span> <span class="token keyword">implements</span> <span class="token class-name">DeferredImportSelector</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AutoConfiguration</span><span class="token punctuation">&gt;</span></span> serviceLoader <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">AutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">AutoConfiguration</span> autoConfiguration <span class="token operator">:</span> serviceLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>autoConfiguration<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åŠ è½½è‡ªåŠ¨é…ç½®ç±»ï¼š&quot;</span> <span class="token operator">+</span> autoConfiguration<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿™å°±å®Œæˆäº†ä»org.hzz.springboot.AutoConfigurationæ–‡ä»¶ä¸­è·å–è‡ªåŠ¨é…ç½®ç±»çš„åå­—ï¼Œå¹¶å¯¼å…¥åˆ°Springå®¹å™¨ä¸­ï¼Œä»è€ŒSpringå®¹å™¨å°±çŸ¥é“äº†è¿™äº›é…ç½®ç±»çš„å­˜åœ¨ï¼Œè€Œå¯¹äºuseré¡¹ç›®è€Œè¨€ï¼Œæ˜¯ä¸éœ€è¦ä¿®æ”¹ä»£ç çš„ã€‚</p><h2 id="æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•" aria-hidden="true">#</a> æµ‹è¯•</h2><h3 id="tomcat" tabindex="-1"><a class="header-anchor" href="#tomcat" aria-hidden="true">#</a> tomcat</h3><p>æ­¤æ—¶è¿è¡ŒApplicationï¼Œå°±èƒ½çœ‹åˆ°å¯åŠ¨äº†Tomcatï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>åŠ è½½è‡ªåŠ¨é…ç½®ç±»ï¼šorg.hzz.springboot.WebServiceAutoConfiguration
å‡†å¤‡åŠ è½½ç±»ï¼šorg.apache.catalina.startup.Tomcat
åŠ è½½ç±»æˆåŠŸï¼šorg.apache.catalina.startup.Tomcat
å‡†å¤‡åŠ è½½ç±»ï¼šorg.eclipse.jetty.server.Server
åŠ è½½ç±»å¤±è´¥ï¼šorg.eclipse.jetty.server.Server
TomcatServer start
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="jetty" tabindex="-1"><a class="header-anchor" href="#jetty" aria-hidden="true">#</a> jetty</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.hzz.springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.eclipse.jetty<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jetty-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>9.4.43.v20210629<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>åŠ è½½è‡ªåŠ¨é…ç½®ç±»ï¼š<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>hzz<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span></span>WebServiceAutoConfiguration</span>
å‡†å¤‡åŠ è½½ç±»ï¼š<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>startup<span class="token punctuation">.</span></span>Tomcat</span>
åŠ è½½ç±»å¤±è´¥ï¼š<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>catalina<span class="token punctuation">.</span>startup<span class="token punctuation">.</span></span>Tomcat</span>
å‡†å¤‡åŠ è½½ç±»ï¼š<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>jetty<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>Server</span>
åŠ è½½ç±»æˆåŠŸï¼š<span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>jetty<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>Server</span>
<span class="token class-name">JettyServer</span> start
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/springboot/" class="nav-link router-link-active" aria-label="Back To ç›®å½•"><!--[--><!--]--> Back To ç›®å½• <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.2c87fbe0.js" defer></script><script src="/assets/js/95615.aba5921d.js" defer></script><script src="/assets/js/app.4aafd1f6.js" defer></script>
  </body>
</html>
