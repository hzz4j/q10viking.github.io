<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/images/favicon-32x32.png"><title>é™é»˜ã®Blog</title><meta name="description" content="é™é»˜çš„Vuepress Blog">
    <link rel="preload" href="/assets/js/runtime~app.2c87fbe0.js" as="script"><link rel="preload" href="/assets/css/styles.b779b927.css" as="style"><link rel="preload" href="/assets/js/95615.aba5921d.js" as="script"><link rel="preload" href="/assets/js/app.4aafd1f6.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.b779b927.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">é™é»˜ã®Blog</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="ğŸ“—Menu"><!--[--><!--]--> ğŸ“—Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item"></p><ul class=""><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#springbootè‡ªåŠ¨é…ç½®çš„åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="SpringBootè‡ªåŠ¨é…ç½®çš„åŸç†"><!--[--><!--]--> SpringBootè‡ªåŠ¨é…ç½®çš„åŸç† <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#è‡ªåŠ¨é…ç½®ç±»" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="è‡ªåŠ¨é…ç½®ç±»"><!--[--><!--]--> è‡ªåŠ¨é…ç½®ç±» <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#æ¡ä»¶æ³¨è§£" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ¡ä»¶æ³¨è§£"><!--[--><!--]--> æ¡ä»¶æ³¨è§£ <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#å…·ä½“åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å…·ä½“åŸç†"><!--[--><!--]--> å…·ä½“åŸç† <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#starteræœºåˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="starteræœºåˆ¶"><!--[--><!--]--> starteræœºåˆ¶ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#é¡ºåºé—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="é¡ºåºé—®é¢˜"><!--[--><!--]--> é¡ºåºé—®é¢˜ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#åŠ è½½é…ç½®ç±»" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="åŠ è½½é…ç½®ç±»"><!--[--><!--]--> åŠ è½½é…ç½®ç±» <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#è¯»å–springbootçš„importså’Œspring-factoriesæ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="è¯»å–SpringBootçš„importså’Œspring.factoriesæ–‡ä»¶"><!--[--><!--]--> è¯»å–SpringBootçš„importså’Œspring.factoriesæ–‡ä»¶ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#è§£æ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="è§£æ"><!--[--><!--]--> è§£æ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/springboot/08%20%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html#è¿‡æ»¤" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="è¿‡æ»¤"><!--[--><!--]--> è¿‡æ»¤ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="springbootè‡ªåŠ¨é…ç½®çš„åŸç†" tabindex="-1"><a class="header-anchor" href="#springbootè‡ªåŠ¨é…ç½®çš„åŸç†" aria-hidden="true">#</a> SpringBootè‡ªåŠ¨é…ç½®çš„åŸç†</h2><p>SpringBooté›†æˆç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œéƒ½æ˜¯æœ‰@EnableXXX,@import</p><p>å»¶è¿Ÿï¼Œåˆ†ç»„çš„ç‰¹æ€§DeferredImportSelector+Conditionæ¥å¤„ç†springbootçº¦å®šé…ç½®çš„è®¸å¤šbean,ä»¥åŠè§£å†³é¡ºåºé—®é¢˜</p><p>DeferredImportSelectorè¿˜æœ‰ä¸€ä¸ªGroupï¼Œä¼šè°ƒç”¨processæ–¹æ³•æ¥å¤„ç†spring.factoriesæ–‡ä»¶</p><p>Spring.factories é…ç½®ä¸­çš„ç±»ç­›é€‰ï¼Œæ ¹æ®key,<strong>å†æ ¹æ®starteråœºæ™¯å¯åŠ¨å™¨,ä»¥åŠé…ç½®çš„Condition</strong>ï¼Œä½¿å¾—ç±»å˜æˆbeanæ”¾å…¥åˆ°å®¹å™¨ä¸­ç”Ÿæ•ˆ</p><p>çœ‹é…ç½®ç±»çš„å®šåˆ¶æ–¹å¼ï¼Œæ¥è‡ªå·±è¦†ç›–ï¼Œæˆ–è€…æ ¹æ®å…¨å±€é…ç½®æ–‡ä»¶</p><hr><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>ä¾èµ–çš„ç±»æŠ¥çº¢æ•ˆæœï¼Œmaven çš„optional è®¾ç½®ä¸ºtrue,ä¸ä¼šä¼ é€’</p></div><h2 id="è‡ªåŠ¨é…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨é…ç½®ç±»" aria-hidden="true">#</a> è‡ªåŠ¨é…ç½®ç±»</h2><p><a href="https://github.com/Q10Viking/learncode/tree/main/springboot/_02-springboot-start-analysis" target="_blank" rel="noopener noreferrer">Source Code<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><ol><li>ServletWebServerFactoryAutoConfigurationï¼šé…ç½®äº†Servlet Webåœºæ™¯ä¸­æ‰€éœ€è¦çš„ä¸€äº›Bean</li><li>TransactionAutoConfigurationï¼šé…ç½®äº†äº‹åŠ¡åœºæ™¯ä¸­æ‰€éœ€è¦çš„ä¸€äº›Bean</li><li>AopAutoConfigurationï¼šé…ç½®äº†AOPåœºæ™¯ä¸­æ‰€éœ€è¦çš„ä¸€äº›Bean</li><li>RabbitAutoConfigurationï¼šé…ç½®äº†Rabbitmqåœºæ™¯ä¸­æ‰€éœ€è¦çš„ä¸€äº›Bean</li></ol><p>ä½¿ç”¨è¿™ç§ç»“æ„åï¼ŒSpringBootå°±èƒ½è®©ç¨‹åºå‘˜æ›´ä¸ºæ–¹ä¾¿çš„æ¥æ§åˆ¶<strong>æŸä¸ªBeanæˆ–æŸäº›Beanè¦ä¸è¦ç”Ÿæ•ˆ</strong>ï¼Œå¦‚æœæŸä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸ç”Ÿæ•ˆï¼Œé‚£è¯¥é…ç½®ç±»ä¸­æ‰€å®šä¹‰çš„Beanåˆ™éƒ½ä¸ä¼šç”Ÿæ•ˆ</p><p><img src="/images/springboot/image-20230407191749448.png" alt="image-20230407191749448"></p><h2 id="æ¡ä»¶æ³¨è§£" tabindex="-1"><a class="header-anchor" href="#æ¡ä»¶æ³¨è§£" aria-hidden="true">#</a> æ¡ä»¶æ³¨è§£</h2><blockquote><p>SpringBootæ§åˆ¶æŸä¸ªè‡ªåŠ¨é…ç½®ç±»æˆ–æŸä¸ªBeanç”Ÿä¸ç”Ÿæ•ˆ</p></blockquote><ol><li>ConditionalOnBeanï¼šæ˜¯å¦å­˜åœ¨æŸä¸ªæŸç±»æˆ–æŸä¸ªåå­—çš„Bean</li><li>ConditionalOnMissingBeanï¼šæ˜¯å¦ç¼ºå¤±æŸä¸ªæŸç±»æˆ–æŸä¸ªåå­—çš„Bean</li><li>ConditionalOnSingleCandidateï¼šæ˜¯å¦ç¬¦åˆæŒ‡å®šç±»å‹çš„Beanåªæœ‰ä¸€ä¸ª</li><li>ConditionalOnClassï¼šæ˜¯å¦å­˜åœ¨æŸä¸ªç±»</li><li>ConditionalOnMissingClassï¼šæ˜¯å¦ç¼ºå¤±æŸä¸ªç±»</li><li>ConditionalOnExpressionï¼šæŒ‡å®šçš„è¡¨è¾¾å¼è¿”å›çš„æ˜¯trueè¿˜æ˜¯false</li><li>ConditionalOnJavaï¼šåˆ¤æ–­Javaç‰ˆæœ¬</li><li>ConditionalOnJndiï¼šJNDIæŒ‡å®šçš„èµ„æºæ˜¯å¦å­˜åœ¨</li><li>ConditionalOnWebApplicationï¼šå½“å‰åº”ç”¨æ˜¯ä¸€ä¸ªWebåº”ç”¨</li><li>ConditionalOnNotWebApplicationï¼šå½“å‰åº”ç”¨ä¸æ˜¯ä¸€ä¸ªWebåº”ç”¨</li><li>ConditionalOnPropertyï¼šEnvironmentä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§</li><li>ConditionalOnResourceï¼šæŒ‡å®šçš„èµ„æºæ˜¯å¦å­˜åœ¨</li><li>ConditionalOnWarDeploymentï¼šå½“å‰é¡¹ç›®æ˜¯ä¸æ˜¯ä»¥WaråŒ…éƒ¨ç½²çš„æ–¹å¼è¿è¡Œ</li><li>ConditionalOnCloudPlatformï¼šæ˜¯ä¸æ˜¯åœ¨æŸä¸ªäº‘å¹³å°ä¸Š</li></ol><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨@Conditionalæ¥è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£ã€‚</p><p>æ¡ä»¶æ³¨è§£æ˜¯å¯ä»¥å†™åœ¨ç±»ä¸Šå’Œæ–¹æ³•ä¸Šçš„ï¼Œå¦‚æœæŸä¸ªæ¡ä»¶æ³¨è§£å†™åœ¨äº†è‡ªåŠ¨é…ç½®ç±»ä¸Šï¼Œé‚£è¯¥è‡ªåŠ¨é…ç½®ç±»ä¼šä¸ä¼šç”Ÿæ•ˆå°±è¦çœ‹å½“å‰æ¡ä»¶èƒ½ä¸èƒ½ç¬¦åˆï¼Œæˆ–è€…æ¡ä»¶æ³¨è§£å†™åœ¨æŸä¸ª@Beanä¿®é¥°çš„æ–¹æ³•ä¸Šï¼Œé‚£è¿™ä¸ªBeanç”Ÿä¸ç”Ÿæ•ˆå°±çœ‹å½“å‰æ¡ä»¶ç¬¦ä¸ç¬¦åˆã€‚</p><h3 id="å…·ä½“åŸç†" tabindex="-1"><a class="header-anchor" href="#å…·ä½“åŸç†" aria-hidden="true">#</a> å…·ä½“åŸç†</h3><ol><li>Springåœ¨è§£ææŸä¸ªè‡ªåŠ¨é…ç½®ç±»æ—¶ï¼Œä¼šå…ˆæ£€æŸ¥è¯¥è‡ªåŠ¨é…ç½®ç±»ä¸Šæ˜¯å¦æœ‰æ¡ä»¶æ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿›ä¸€æ­¥åˆ¤æ–­è¯¥æ¡ä»¶æ³¨è§£æ‰€æŒ‡å®šçš„æ¡ä»¶å½“å‰èƒ½ä¸èƒ½æ»¡è¶³ï¼Œå¦‚æœæ»¡è¶³äº†åˆ™ç»§ç»­è§£æè¯¥é…ç½®ç±»ï¼Œå¦‚æœä¸æ»¡è¶³åˆ™ä¸è¿›è¡Œè§£æäº†ï¼Œä¹Ÿå°±æ˜¯é…ç½®ç±»æ‰€å®šä¹‰çš„Beanéƒ½å¾—ä¸åˆ°è§£æï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæ²¡æœ‰è¿™äº›Beanäº†ã€‚</li><li>åŒç†ï¼ŒSpringåœ¨è§£ææŸä¸ª@Beançš„æ–¹æ³•æ—¶ï¼Œä¹Ÿä¼šå…ˆåˆ¤æ–­æ–¹æ³•ä¸Šæ˜¯å¦æœ‰æ¡ä»¶æ³¨è§£ï¼Œç„¶åè¿›è¡Œè§£æï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¯¥Beanä¸ä¼šç”Ÿæ•ˆ</li></ol><blockquote><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒSpringBootçš„è‡ªåŠ¨é…ç½®ï¼Œå®é™…ä¸Šå°±æ˜¯SpringBootçš„æºç ä¸­é¢„å…ˆå†™å¥½äº†ä¸€äº›é…ç½®ç±»ï¼Œé¢„å…ˆå®šä¹‰å¥½äº†ä¸€äº›Beanï¼Œæˆ‘ä»¬åœ¨ç”¨SpringBootæ—¶ï¼Œè¿™äº›é…ç½®ç±»å°±å·²ç»åœ¨æˆ‘ä»¬é¡¹ç›®çš„ä¾èµ–ä¸­äº†ï¼Œè€Œè¿™äº›è‡ªåŠ¨é…ç½®ç±»æˆ–è‡ªåŠ¨é…ç½®Beanåˆ°åº•ç”Ÿä¸ç”Ÿæ•ˆï¼Œå°±çœ‹å…·ä½“æ‰€æŒ‡å®šçš„æ¡ä»¶äº†ã€‚</p></blockquote><h2 id="starteræœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#starteræœºåˆ¶" aria-hidden="true">#</a> starteræœºåˆ¶</h2><blockquote><p>SpringBootä¸­çš„Starterå’Œè‡ªåŠ¨é…ç½®åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p></blockquote><p>å…¶å®é¦–å…ˆè¦æ˜ç™½ä¸€ä¸ªStarterï¼Œå°±æ˜¯ä¸€ä¸ªMavenä¾èµ–ï¼Œå½“æˆ‘ä»¬åœ¨é¡¹ç›®çš„pom.xmlæ–‡ä»¶ä¸­æ·»åŠ æŸä¸ªStarterä¾èµ–æ—¶ï¼Œå…¶å®å°±æ˜¯ç®€å•çš„æ·»åŠ äº†å¾ˆå¤šå…¶ä»–çš„ä¾èµ–ï¼Œæ¯”å¦‚ï¼š</p><ol><li>spring-boot-starter-webï¼šå¼•å…¥äº†spring-boot-starterã€spring-boot-starter-jsonã€spring-boot-starter-tomcatç­‰å’ŒWebå¼€å‘ç›¸å…³çš„ä¾èµ–åŒ…</li><li>spring-boot-starter-tomcatï¼šå¼•å…¥äº†tomcat-embed-coreã€tomcat-embed-elã€tomcat-embed-websocketç­‰å’ŒTomcatç›¸å…³çš„ä¾èµ–åŒ…</li></ol><p><img src="/images/springboot/image-20230407192558680.png" alt="image-20230407192558680"></p><p>å¦‚æœç¡¬è¦æŠŠStarteræœºåˆ¶å’Œè‡ªåŠ¨é…ç½®è”ç³»èµ·æ¥ï¼Œé‚£å°±æ˜¯é€šè¿‡@ConditionalOnClassè¿™ä¸ªæ¡ä»¶æ³¨è§£ï¼Œå› ä¸ºè¿™ä¸ªæ¡ä»¶æ³¨è§£çš„ä½œç”¨å°±æ˜¯ç”¨æ¥åˆ¤æ–­å½“å‰åº”ç”¨çš„ä¾èµ–ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªç±»æˆ–æŸäº›ç±»ï¼Œæ¯”å¦‚ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Tomcat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UpgradeProtocol</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ServletWebServerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EmbeddedTomcat</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">TomcatServletWebServerFactory</span> <span class="token function">tomcatServletWebServerFactory</span><span class="token punctuation">(</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatConnectorCustomizer</span><span class="token punctuation">&gt;</span></span> connectorCustomizers<span class="token punctuation">,</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatContextCustomizer</span><span class="token punctuation">&gt;</span></span> contextCustomizers<span class="token punctuation">,</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatProtocolHandlerCustomizer</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> protocolHandlerCustomizers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TomcatServletWebServerFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServletWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatConnectorCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>connectorCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatContextCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>contextCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatProtocolHandlerCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>protocolHandlerCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> factory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>ä¸Šé¢ä»£ç ä¸­å°±ç”¨åˆ°äº†@ConditionalOnClassï¼Œç”¨æ¥åˆ¤æ–­é¡¹ç›®ä¸­æ˜¯å¦å­˜åœ¨Servlet.classã€Tomcat.classã€UpgradeProtocol.classè¿™ä¸‰ä¸ªç±»ï¼Œå¦‚æœå­˜åœ¨å°±æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œå¦‚æœé¡¹ç›®ä¸­å¼•å…¥äº†spring-boot-starter-tomcatï¼Œé‚£å°±æœ‰è¿™ä¸‰ä¸ªç±»ï¼Œå¦‚æœæ²¡æœ‰spring-boot-starter-tomcaté‚£å°±å¯èƒ½æ²¡æœ‰è¿™ä¸‰ä¸ªç±»ï¼ˆé™¤éä½ è‡ªå·±å•ç‹¬å¼•å…¥äº†Tomcatç›¸å…³çš„ä¾èµ–ï¼‰ã€‚</p><p>è€Œå¦‚æœä¸æƒ³ç”¨Tomcatï¼Œé‚£å°±å¾—è¿™ä¹ˆå†™ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jetty<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>å¾—æŠŠspring-boot-starter-tomcatç»™æ’é™¤æ‰ï¼Œå†æ·»åŠ ä¸Šspring-boot-starter-jettyçš„ä¾èµ–ï¼Œè¿™æ ·Tomcatçš„Beanå°±ä¸ä¼šç”Ÿæ•ˆï¼ŒJettyçš„Beanå°±èƒ½ç”Ÿæ•ˆï¼Œä»è€Œé¡¹ç›®ä¸­ç”¨çš„å°±æ˜¯Jettyã€‚</p><p><img src="/images/springboot/image-20230407194901783.png" alt="image-20230407194901783"></p><h2 id="é¡ºåºé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#é¡ºåºé—®é¢˜" aria-hidden="true">#</a> é¡ºåºé—®é¢˜</h2><p>@ConditionalOnMissingBeançš„ä½œç”¨æ˜¯ç”¨æ¥åˆ¤æ–­æŸä¸ªBeanæ˜¯å¦ç¼ºå¤±ï¼Œå¦‚æœ<strong>ä¸å­˜åœ¨</strong>æŸä¸ªBeanï¼Œé‚£å°±<strong>ç¬¦åˆè¯¥æ¡ä»¶</strong>ï¼Œç†è§£èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ç»†ç»†æƒ³ä¸€ä¸‹å°±ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é¡ºåºé—®é¢˜ï¼Œè¿˜æ˜¯æ‹¿ä¸Šé¢çš„ä»£ç ä¸¾ä¾‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">Servlet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Tomcat</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UpgradeProtocol</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">ServletWebServerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> search <span class="token operator">=</span> <span class="token class-name">SearchStrategy</span><span class="token punctuation">.</span><span class="token constant">CURRENT</span><span class="token punctuation">)</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EmbeddedTomcat</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">TomcatServletWebServerFactory</span> <span class="token function">tomcatServletWebServerFactory</span><span class="token punctuation">(</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatConnectorCustomizer</span><span class="token punctuation">&gt;</span></span> connectorCustomizers<span class="token punctuation">,</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatContextCustomizer</span><span class="token punctuation">&gt;</span></span> contextCustomizers<span class="token punctuation">,</span>
        <span class="token class-name">ObjectProvider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatProtocolHandlerCustomizer</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> protocolHandlerCustomizers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TomcatServletWebServerFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServletWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatConnectorCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>connectorCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatContextCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>contextCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        factory<span class="token punctuation">.</span><span class="token function">getTomcatProtocolHandlerCustomizers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>protocolHandlerCustomizers<span class="token punctuation">.</span><span class="token function">orderedStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> factory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>è¿™ä¸ªä»£ç ä¸­å°±ç”¨åˆ°äº†@ConditionalOnMissingBeanï¼Œæ„æ€æ˜¯å¦‚æœå½“å‰ä¸å­˜åœ¨ServletWebServerFactoryç±»å‹çš„Beanï¼Œé‚£å°±ç¬¦åˆæ¡ä»¶ï¼Œç»“åˆæ•´ä½“ä»£ç ï¼Œæ„æ€å°±æ˜¯ï¼Œï¼š</p><ol><li>å¦‚æœç”¨æˆ·è‡ªå·±<strong>æ²¡æœ‰å®šä¹‰</strong>ServletWebServerFactoryç±»å‹çš„Beanï¼Œé‚£ä»£ç ä¸­æ‰€å®šä¹‰çš„Beanå°±ä¼š<strong>ç”Ÿæ•ˆ</strong>ï¼Œ</li><li>å¦‚æœç”¨æˆ·è‡ªå·±å®šä¹‰äº†ServletWebServerFactoryç±»å‹çš„Beanï¼Œé‚£ä»£ç ä¸­å®šä¹‰çš„Beanå°±ä¸ç”Ÿæ•ˆ</li></ol><p>æ‰€ä»¥è¿™ä¸ªæ³¨è§£æ˜¯éå¸¸é‡è¦çš„ï¼ŒSpringBootåˆ©ç”¨è¿™ä¸ªæ³¨è§£æ¥å†³å®šåˆ°åº•ç”¨ç”¨æˆ·è‡ªå·±çš„Beanï¼Œè¿˜æ˜¯ç”¨SpringBootè‡ªåŠ¨é…ç½®çš„ã€‚</p><p>å…³é”®é—®é¢˜åœ¨äºï¼Œä¸ç®¡æ˜¯è‡ªåŠ¨é…ç½®ç±»ä¸­å®šä¹‰çš„Beanï¼Œè¿˜æ˜¯ç”¨æˆ·å®šä¹‰çš„Beanï¼Œéƒ½æ˜¯éœ€è¦è§£æçš„ï¼Œè€Œä¸”æ˜¯æœ‰ä¸€ä¸ªé¡ºåºçš„ã€‚</p><p>å¦‚æœæ˜¯ï¼š</p><ol><li>å…ˆè§£æçš„SpringBootè‡ªåŠ¨é…ç½®ç±»ï¼Œæ¯”å¦‚ä¸Šé¢çš„EmbeddedTomcatç±»</li><li>å†è§£æç¨‹åºå‘˜å®šä¹‰çš„Bean</li></ol><p>é‚£@ConditionalOnMissingBeançš„åˆ¤æ–­ç»“æœæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºæ˜¯å…ˆè§£æçš„EmbeddedTomcatï¼Œåœ¨è§£æçš„æ—¶å€™æ˜¯æ²¡æœ‰å‘ç°ç¨‹åºå‘˜æ‰€å®šä¹‰çš„Beançš„ï¼Œå°±ä¼šè®¤ä¸ºç¬¦åˆ@ConditionalOnMissingBeançš„æ¡ä»¶ï¼Œè€Œå®é™…ä¸Šç¨‹åºå‘˜æ˜¯å®šä¹‰äº†çš„ï¼Œåªæ˜¯è¿˜æ²¡æœ‰è§£æåˆ°ï¼Œæ‰€ä»¥è¿™å°±éœ€è¦SpringBootæŠŠè¿™ä¸ªé¡ºåºæ§åˆ¶å¥½ï¼Œæ§åˆ¶ä¸ºï¼š</p><ol><li>å…ˆè§£æç”¨æˆ·çš„å®šä¹‰çš„Beanï¼Œä¹Ÿå°±æ˜¯è§£æç”¨æˆ·å®šä¹‰çš„é…ç½®ç±»ï¼ˆåŒ…å«äº†æ‰«æå’Œ@Beançš„è§£æï¼‰</li><li>å†è§£æSpringBootä¸­çš„è‡ªåŠ¨é…ç½®ç±»</li></ol><p>ä¸ç®¡æ˜¯ç”¨æˆ·å®šä¹‰çš„é…ç½®ç±»è¿˜æ˜¯è‡ªåŠ¨é…ç½®ç±»ï¼Œéƒ½æ˜¯é…ç½®ç±»ï¼ˆç®€å•ç†è§£å°±æ˜¯åŠ äº†@Configurationæ³¨è§£ï¼‰ã€‚SpringBootå¯åŠ¨æ—¶ï¼Œæœ€æ ¸å¿ƒçš„ä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªSpringå®¹å™¨ï¼Œè€Œåˆ›å»ºSpringå®¹å™¨çš„è¿‡ç¨‹ä¸­ä¼šæ³¨è§£åšå‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>æŠŠSpringApplication.run(MyApplication.class)ä¼ å…¥è¿›æ¥çš„MyApplicationç±»åšä¸ºé…ç½®ç±»è¿›è¡Œè§£æ</li><li>ç”±äºMyApplicationç±»ä¸Šå®šä¹‰äº†@SpringBootApplicationï¼Œç›¸å½“äºå®šä¹‰äº†@SpringBootConfigurationã€@EnableAutoConfigurationã€@ComponentScanæ³¨è§£</li><li>æ‰€ä»¥SpringBootä¼šè¿›ä¸€æ­¥è§£æè¿™äº›æ³¨è§£</li></ol><ul><li><ol><li>@EnableAutoConfigurationï¼šé€šè¿‡@importæ³¨è§£å¯¼å…¥AutoConfigurationImportSelectorè¿™ä¸ªé…ç½®ç±»ï¼Œå› ä¸ºå®ƒå®ç°äº†DeferredImportSelectoræ¥å£ï¼Œæ‰€ä»¥Springä¼šåœ¨æŠŠå…¶ä»–é…ç½®ç±»éƒ½è§£æå®Œä¹‹åæ‰è§£æAutoConfigurationImportSelectorï¼ˆSpring Frameworkä¸­çš„çŸ¥è¯†ï¼‰</li><li>@ComponentScanï¼šæ‰«æï¼Œæ‰«ææ—¶ä¼šæ‰«æåˆ°ç”¨æˆ·æ‰€å®šä¹‰çš„é…ç½®ç±»ï¼Œå¹¶è§£æç”¨æˆ·çš„é…ç½®ç±»ï¼Œæ³¨æ„ï¼šæ‰«ææ˜¯æ‰«æä¸åˆ°SpringBootçš„è‡ªåŠ¨é…ç½®çš„ç±»ï¼Œå› ä¸ºæ‰«æçš„åŒ…è·¯å¾„ä¸åŒ¹é…ï¼ŒSpringBootçš„åŒ…éƒ½æ˜¯org.springframework.boot.xxxxï¼Œç”¨æˆ·éƒ½æ˜¯è‡ªå·±çš„åŒ…è·¯å¾„ã€‚</li></ol></li></ul><p>é€šè¿‡ä¸Šè¿°è¿‡ç¨‹æˆ‘ä»¬å‘ç°ï¼ŒSpringä¼šåœ¨æœ€åæ‰æ¥è§£æAutoConfigurationImportSelectorè¿™ä¸ªé…ç½®ç±»ï¼Œè€Œè¿™ä¸ªç±»çš„ä½œç”¨å°±æ˜¯ç”¨æ¥è§£æSpringBootçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé‚£æ—¢ç„¶æ— æ³•æ‰«æåˆ°SpringBootä¸­çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œé‚£æ€ä¹ˆçŸ¥é“SpringBootä¸­æœ‰å“ªäº›è‡ªåŠ¨é…ç½®ç±»å‘¢ï¼Œè¿™å°±éœ€è¦spring.factoriesæ–‡ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringBootä¼šæä¾›ä¸€ä¸ªspring.factoriesæ–‡ä»¶ï¼Œå¹¶æŠŠæ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»çš„åå­—è®°å½•åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œåˆ°æ—¶å€™å¯åŠ¨è¿‡ç¨‹ä¸­è§£æè¿™ä¸ªæ–‡ä»¶å°±çŸ¥é“æœ‰å“ªäº›è‡ªåŠ¨é…ç½®ç±»äº†ï¼Œå¹¶ä¸”è¿™ä»¶äº‹ä¹Ÿæ˜¯å‘ç”Ÿåœ¨è§£æå®Œç”¨æˆ·çš„é…ç½®ç±»ä¹‹åçš„ã€‚</p><hr><h2 id="åŠ è½½é…ç½®ç±»" tabindex="-1"><a class="header-anchor" href="#åŠ è½½é…ç½®ç±»" aria-hidden="true">#</a> åŠ è½½é…ç½®ç±»</h2><p><a href="https://www.processon.com/view/link/642fcfc5242fb51ae706088b" target="_blank" rel="noopener noreferrer">Link<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><iframe id="embed_dom" name="embed_dom" frameborder="0" style="display:block;width:625px;height:345px;" src="https://www.processon.com/view/link/642fcfc5242fb51ae706088b"></iframe><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootConfiguration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">TypeExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token class-name">AutoConfigurationExcludeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¦‚æœæˆ‘ä»¬è¿™ä¹ˆç”¨å°±èƒ½è‡ªå·±æ§åˆ¶è¦ä¸è¦ç”¨@EnableAutoConfigurationè¿™ä¸ªæ³¨è§£ï¼Œå¦‚æœç”¨å°±è¡¨ç¤ºå¼€å¯è‡ªåŠ¨é…ç½®ï¼Œå¦‚æœä¸ç”¨å°±è¡¨ç¤ºä¸å¼€å¯è‡ªåŠ¨é…ç½®ï¼Œé‚£å¼€å¯å’Œä¸å¼€å¯è‡ªåŠ¨é…ç½®åˆ°åº•è¯¥æ€ä¹ˆç†è§£å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‰é¢åˆ†æè¿‡ï¼ŒSpringBootçš„è‡ªåŠ¨é…ç½®å°±æ˜¯SpringBootå¸®åŠ©ç¨‹åºå‘˜é…ç½®ä¸€äº›Beanï¼Œä»è€Œè®©ç¨‹åºå‘˜åœ¨ç”¨SpringBootæ—¶å¯ä»¥å°‘å»é…ç½®å¾ˆå¤šBeanï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¼€å¯äº†è‡ªåŠ¨é…ç½®ï¼Œé‚£æœ€ç»ˆSpringå®¹å™¨ä¸­å°±æœ‰SpringBootå¸®æˆ‘ä»¬é…ç½®çš„Beanï¼Œå¦‚æœæ²¡æœ‰å¼€å¯è‡ªåŠ¨é…ç½®ï¼Œé‚£Springå®¹å™¨ä¸­å°±æ²¡æœ‰è¿™äº›Beanï¼Œå°±éœ€è¦ç¨‹åºå‘˜å»é…ç½®ã€‚</p><p>é‚£æˆ‘ä»¬æ¥çœ‹çœ‹@EnableAutoConfigurationè¿™ä¸ªæ³¨è§£æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå…ˆçœ‹æºç å®šä¹‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@AutoConfigurationPackage</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>	<span class="token comment">//	éå¸¸æ ¸å¿ƒ</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>AutoConfigurationImportSelectorå®ç°äº†DeferredImportSelectorè¿™ä¸ªæ¥å£ï¼ŒSpringå®¹å™¨åœ¨å¯åŠ¨æ—¶ï¼Œä¼šåœ¨è§£æå®Œå…¶ä»–æ‰€æœ‰ç¨‹åºå‘˜å®šä¹‰çš„é…ç½®ç±»ä¹‹åï¼Œæ¥è°ƒç”¨AutoConfigurationImportSelectorä¸­çš„selectImportsæ–¹æ³•ï¼Œç„¶åæŠŠè¯¥æ–¹æ³•è¿”å›çš„ç±»åå¯¹åº”çš„ç±»ä½œä¸ºé…ç½®ç±»è¿›è¡Œè§£æã€‚</p><p>è¯¥æ–¹æ³•ä¼šåˆ©ç”¨SpringFactoriesLoaderæ‰¾åˆ°æ‰€æœ‰çš„META-INF/spring.factoriesæ–‡ä»¶ä¸­keyä¸ºEnableAutoConfiguration.classçš„valueå€¼ï¼Œä¹Ÿå°±æ˜¯ä¼—å¤šè‡ªåŠ¨é…ç½®ç±»çš„ç±»åã€‚</p><h3 id="è¯»å–springbootçš„importså’Œspring-factoriesæ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#è¯»å–springbootçš„importså’Œspring-factoriesæ–‡ä»¶" aria-hidden="true">#</a> è¯»å–SpringBootçš„importså’Œspring.factoriesæ–‡ä»¶</h3><blockquote><p>å­˜æ”¾çš„éƒ½æ˜¯è‡ªåŠ¨é…ç½®ç±»</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>org.springframework.boot.autoconfigure.AutoConfiguration.imports
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><img src="/images/springboot/image-20230407142412446.png" alt="image-20230407142412446"></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="è§£æ" tabindex="-1"><a class="header-anchor" href="#è§£æ" aria-hidden="true">#</a> è§£æ</h3><p>å‚è€ƒï¼š<a href="https://q10viking.github.io/FileSystem/06%20%E8%AF%BB%E6%96%87%E4%BB%B6.html" target="_blank" rel="noopener noreferrer">è¯»æ–‡ä»¶-Q10Viking<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h3 id="è¿‡æ»¤" tabindex="-1"><a class="header-anchor" href="#è¿‡æ»¤" aria-hidden="true">#</a> è¿‡æ»¤</h3><p><img src="/images/springboot/image-20230407202837845.png" alt="image-20230407202837845"></p><blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>META-INF/spring-autoconfigure-metadata.properties
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></blockquote><p><img src="/images/springboot/image-20230407202736639.png" alt="image-20230407202736639"></p><p>å…¶å®è¿‡æ»¤å¾ˆå¾ˆç®€å•ï¼Œçœ‹çœ‹ç»„è£…çš„åœ¨ä¸åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰æ²¡æœ‰value.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> defaultValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>className <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> value <span class="token operator">:</span> defaultValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// className-&gt; org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration</span>
<span class="token comment">// defaultValue-&gt; ConditionalOnClass</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>springbootçš„application.propertiesä¸­é…ç½®<code>debug=true</code>,å¯ä»¥çœ‹åˆ°åŒ¹é…çš„ç±»å‹</p></div><p><img src="/images/springboot/image-20230408153841606.png" alt="image-20230408153841606"></p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>æ‰‹å†™è¿‡æ»¤ï¼Œåœ¨çœ‹æºç çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å®ƒçš„è¿™ç§è®¾è®¡éå¸¸å·§å¦™ï¼Œç”¨æ¥ä¸¤ä¸ªçº¿ç¨‹æ¥å¤„ç†è¿‡æ»¤ï¼Œæ‰“ç®—æ¨¡æ‹Ÿå®ç°ä¸€ä¸‹</p></div><p><a href="https://github.com/Q10Viking/learncode/tree/main/javafile/_03-read-properties-file-filter" target="_blank" rel="noopener noreferrer">Source Code<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>èµ·ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œï¼Œç„¶åä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œä»»åŠ¡ï¼Œç„¶åç­‰å¾…ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹å†ç»§ç»­æ‰§è¡Œ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>å°†ä»»åŠ¡åˆ†æˆä¸¤ä»½
0 1 2 3 4 

0 1
2 3 4 
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations<span class="token punctuation">,</span> <span class="token class-name">Properties</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> match <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>configurations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> split <span class="token operator">=</span> configurations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token comment">// å­çº¿ç¨‹æ‰§è¡Œï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­</span>
    <span class="token class-name">OutcomesResolver</span> first <span class="token operator">=</span> <span class="token function">createOutcomesResolver</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> split<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">OutcomesResolver</span> second <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardOutcomesResolver</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> split<span class="token punctuation">,</span> configurations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¸»çº¿ç¨‹æ‰§è¡Œ</span>
    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> secondHalf <span class="token operator">=</span> second<span class="token punctuation">.</span><span class="token function">resolveOutcomes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•</span>
    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> firstHalf <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">resolveOutcomes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>firstHalf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> match<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> firstHalf<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>secondHalf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> match<span class="token punctuation">,</span> split<span class="token punctuation">,</span> secondHalf<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> match<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">OutcomesResolver</span> <span class="token function">createOutcomesResolver</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations<span class="token punctuation">,</span> <span class="token class-name">Properties</span> metadata<span class="token punctuation">,</span>
                                               <span class="token class-name">String</span> key<span class="token punctuation">,</span><span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">OutcomesResolver</span> outcomesResolver <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">StandardOutcomesResolver</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> key<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadedOutcomesResolver</span><span class="token punctuation">(</span>outcomesResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadedOutcomesResolver</span> <span class="token keyword">implements</span> <span class="token class-name">OutcomesResolver</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> final Thread thread<span class="token punctuation">;</span>
    <span class="token keyword">private</span> volatile boolean<span class="token punctuation">[</span><span class="token punctuation">]</span> outcomes<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">ThreadedOutcomesResolver</span><span class="token punctuation">(</span><span class="token parameter">OutcomesResolver outcomesResolver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>outcomes <span class="token operator">=</span> outcomesResolver<span class="token punctuation">.</span><span class="token function">resolveOutcomes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    @Override
    <span class="token keyword">public</span> boolean<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resolveOutcomes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>InterruptedException e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Thread<span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> outcomes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/springboot/" class="nav-link router-link-active" aria-label="Back To ç›®å½•"><!--[--><!--]--> Back To ç›®å½• <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.2c87fbe0.js" defer></script><script src="/assets/js/95615.aba5921d.js" defer></script><script src="/assets/js/app.4aafd1f6.js" defer></script>
  </body>
</html>
