---
sidebarDepth: 3
sidebar: auto
prev:
  text: Back To ç›®å½•
  link: /vue3/
---

## Watcher

::: tip

:one:èƒ½watch dataä¸­çš„å±æ€§ä¹Ÿèƒ½watch computed properties

:two: ä¸è¿”å›å€¼

:::

price: <span>{{price}}</span> <button @click="price++"> ğŸ‘‰æ”¹å˜priceçš„å€¼ </button>

```js
data(){
    return {
        price: 0
    }
},
watch: {
    // ä¾¦å¬priceï¼Œå½“å®ƒå‘ç”Ÿå˜åŒ–æ—¶
    price(newValue,preValue){
        // ...
        alert(`priceåŸæ¥æ˜¯${preValue}ç°åœ¨å˜æˆ${newValue}`);
    }
}
```

::: tip

å½“computedå’Œwatcheréƒ½èƒ½å®ç°çš„åŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨computedï¼Œå› ä¸ºæ›´åŠ ç®€æ´

:::



## Async with Watch

[Computed Properties and Watchers | Vue.js (vuejs.org)](https://v3.vuejs.org/guide/computed.html#watchers)

å®˜ç½‘çš„ä¾‹å­æ›´æœ‰è¯´æœåŠ›ï¼š This is most useful when you want to perform asynchronous or expensive operations in response to changing data.

<common-codepen-snippet title="Watch basic example" slug="GRJGqXp" :team="true" user="Vue"/> 

:::: code-group
::: code-group-item html

```html {4,6}
<div id="watch-example">
  <p>
    Ask a yes/no question:
    <input v-model="question" />
  </p>
  <p>{{ answer }}</p>
</div>
```

::: 

::: code-group-item js

```js {12,14,24}
<script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
<script>
  const watchExampleVM = Vue.createApp({
    data() {
      return {
        question: '',
        answer: 'Questions usually contain a question mark. ;-)'
      }
    },
    watch: {
      // whenever question changes, this function will run
      question(newQuestion, oldQuestion) {
        if (newQuestion.indexOf('?') > -1) {
          this.getAnswer()
        }
      }
    },
    methods: {
      getAnswer() {
        this.answer = 'Thinking...'
        axios
          .get('https://yesno.wtf/api')
          .then(response => {
            this.answer = response.data.answer
          })
          .catch(error => {
            this.answer = 'Error! Could not reach the API. ' + error
          })
      }
    }
  }).mount('#watch-example')
</script>
```

:::

::::



## watchå¾ªç¯é—®é¢˜ï¼Ÿ

::: tip

å¦‚æœæ˜¯æ”¹å˜è‡ªèº«çš„å€¼ï¼Œå¦‚æœä¸ä¹‹å‰çš„ç›¸åŒåˆ™ä¸ä¼šå†æ¬¡è§¦å‘

:::

<common-codepen-snippet title="watch noloop 1" slug="wvraWPj"/> 

ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œwatchä¼šä¸æ–­è‡ªèº«æ‰§è¡Œä¸‹å»

<common-codepen-snippet title="watch loop" slug="xxXGOzV"/> 



----------

<script>
import {ref} from 'vue';
export default {
    setup(){
        return {
            price: ref(0)
        }
    },
    watch: {
        price(current,old){
            alert(`priceåŸæ¥æ˜¯${old}ç°åœ¨å˜æˆ${current}`);
        }
    }
}
</script>


